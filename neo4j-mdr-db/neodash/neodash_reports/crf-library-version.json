{
  "title": "CRF Library Versions",
  "version": "2.4",
  "settings": {
    "pagenumber": 0,
    "editable": true,
    "fullscreenEnabled": false,
    "parameters": {
      "neodash_odmstudyeventvalue_name": "",
      "neodash_odmstudyeventvalue_name_display": "",
      "neodash_coll_base_id": "",
      "neodash_coll_comp_id": "",
      "neodash_select_crf": "",
      "neodash_select_crf_display": "",
      "neodash_select_group": "",
      "neodash_select_group_display": "",
      "neodash_crf_base_id": "",
      "neodash_crf_comp_id": "",
      "neodash_crf_base_version_num": "",
      "neodash_crf_comp_version_num": "",
      "neodash_odmformvalue_oid": "",
      "neodash_odmformvalue_oid_display": "",
      "neodash_select_group_2": "",
      "neodash_select_group_2_display": "",
      "neodash_odmgroupvalu_oid": "",
      "neodash_odmgroupvalu_oid_display": "",
      "neodash_odmgroupvalue_oid": "",
      "neodash_odmgroupvalue_oid_display": "",
      "neodash_odmitemgroupvalu_oid": "",
      "neodash_odmitemgroupvalu_oid_display": "",
      "neodash_odmitemgroupvalue_oid": "",
      "neodash_odmitemgroupvalue_oid_display": "",
      "neodash_group_base_id": "",
      "neodash_group_base_version_num": "",
      "neodash_group_comp_id": "",
      "neodash_group_comp_version_num": "",
      "neodash_coll_base_version_num": "",
      "neodash_coll_comp_version_num": "",
      "neodash_odmitemvalue_oid": "",
      "neodash_odmitemvalue_oid_display": "",
      "neodash_item_base_id": "",
      "neodash_item_base_version_num": "",
      "neodash_item_comp_id": "",
      "neodash_item_comp_version_num": "",
      "neodash_crf_in_collection": "",
      "neodash_crf_in_collection_display": "",
      "neodash_type_of_change": "",
      "neodash_type_of_change_display": ""
    },
    "theme": "light"
  },
  "pages": [
    {
      "title": "ReadMe",
      "reports": [
        {
          "id": "00a7fa67-6127-495e-8d30-abe699ca2806",
          "title": "Guide",
          "query": "This report allow a user to compare versions of CRF collections as well as individual CRFs.\n\nThe tab **CRF Collection** will be a 'drill-down' approach:\n- select a CRF collection\n- select 2 versions to compare\n- see the difference in CRFs and the CRF attributes in the 2 collections\n- select a CRF in the collections\n- display the differences in Groups and the Group attribute on the CRF\n- select Group on CRF\n- display the differences in Items in the Group and the Item attributes (of the Form in the Collection)\n\n\nThe tab **CRF Versions** will take a CRF focus and display:\n- select a CRF\n- select 2 versions to compare\n- see the difference in CRF Attributes of the two versions\n- display which collections they are in\n- display the differences in Groups and the Group attribute on the CRF\n- select Group on CRF\n- display the differences in Items in the Group and the Item attributes (of the Form in the Collection)\n\nThe tab **Group Versions** will take a Group focus and display:\n- select a Group\n- select 2 versions to compare\n- see the difference in Group Attributes of the two versions\n- display which collections and CRFs they are in\n- select Item in Group \n- display the differences in Items in the Group and the Item attributes\n\nThe tab **Item Versions** will take an Item focus and display:\n- select an Item\n- select 2 versions to compare\n- see the difference in Item Attributes of the two versions\n- display which collections, CRFs and Group they are in\n\n",
          "width": 16,
          "height": 5,
          "x": 0,
          "y": 0,
          "type": "text",
          "selection": {},
          "settings": {}
        }
      ]
    },
    {
      "title": "CRF Collection",
      "reports": [
        {
          "id": "5b4a1242-d493-4b70-949e-a26335a3e691",
          "title": "Select CRF collection",
          "query": "MATCH (n:`OdmStudyEventValue`) \nWHERE toLower(toString(n.`name`)) CONTAINS toLower($input) \nRETURN DISTINCT n.`name` as value,  n.`name` as display ORDER BY size(toString(value)) ASC LIMIT 100",
          "width": 8,
          "height": 2,
          "x": 0,
          "y": 0,
          "type": "select",
          "selection": {},
          "settings": {
            "type": "Node Property",
            "entityType": "OdmStudyEventValue",
            "propertyType": "name",
            "propertyTypeDisplay": "name",
            "parameterName": "neodash_odmstudyeventvalue_name",
            "refreshButtonEnabled": true,
            "suggestionLimit": 100,
            "helperText": "Select a from dropdown"
          },
          "schema": []
        },
        {
          "id": "59dcffb7-87cb-434d-852d-3626ead950e5",
          "title": "Select Base Collection",
          "query": "MATCH\n  (coll_root:OdmStudyEventRoot)-[coll_version:HAS_VERSION]->\n  (coll:OdmStudyEventValue)\nWHERE coll.name = $neodash_odmstudyeventvalue_name\nRETURN\n  coll.name AS `CRF Collection`,\n  coll_version.version AS Version,\n  'Base' AS Select,\n  elementId(coll) AS __coll_id order by `CRF Collection`, Version",
          "width": 8,
          "height": 5,
          "x": 8,
          "y": 0,
          "type": "table",
          "selection": {},
          "settings": {
            "refreshButtonEnabled": true,
            "compact": true,
            "wrapContent": true,
            "columnWidths": "[2,0.5,0.6]",
            "actionsRules": [
              {
                "condition": "Click",
                "field": "Select",
                "value": "__coll_id",
                "customization": "set variable",
                "customizationValue": "coll_base_id"
              },
              {
                "condition": "Click",
                "field": "Select",
                "value": "Version",
                "customization": "set variable",
                "customizationValue": "coll_base_version_num"
              }
            ],
            "noDataMessage": "Select a CRF Collection from the left drop-down"
          }
        },
        {
          "id": "ab577dfa-820a-41ee-8e7d-94afc43e79cf",
          "title": "Select Compare Collection",
          "query": "match(coll_root:OdmStudyEventRoot)-[coll_version:HAS_VERSION]->(coll:OdmStudyEventValue) where coll.name=$neodash_odmstudyeventvalue_name\nreturn coll.name as `CRF Collection`, coll_version.version as Version, 'Compare' as Select, elementId(coll) as __coll_id order by `CRF Collection`, Version\n\n\n",
          "width": 8,
          "height": 5,
          "x": 16,
          "y": 0,
          "type": "table",
          "selection": {},
          "settings": {
            "refreshButtonEnabled": true,
            "compact": true,
            "wrapContent": true,
            "columnWidths": "[2,0.5,0.8]",
            "actionsRules": [
              {
                "condition": "Click",
                "field": "Select",
                "value": "__coll_id",
                "customization": "set variable",
                "customizationValue": "coll_comp_id"
              },
              {
                "condition": "Click",
                "field": "Select",
                "value": "Version",
                "customization": "set variable",
                "customizationValue": "coll_comp_version_num"
              }
            ],
            "noDataMessage": "Select a CRF Collection from the left drop-down"
          }
        },
        {
          "id": "71348e97-0bf7-4b8f-baf0-83348fdf744b",
          "title": "Selected CRF Collection Versions",
          "query": "WITH [\n  {id: $neodash_coll_base_id, version: $neodash_coll_base_version_num, label: 'Base'},\n  {id: $neodash_coll_comp_id, version: $neodash_coll_comp_version_num, label: 'Compare'}\n] AS selections\n\nUNWIND selections AS selection\n\nMATCH (coll_root:OdmStudyEventRoot)-[coll_version:HAS_VERSION]->(coll:OdmStudyEventValue)\nWHERE elementId(coll) = selection.id \n  AND coll_version.version = selection.version\n\nRETURN\n  selection.label as Comparison,\n  coll.name as `Collection Name`,\n  coll_version.version as Version\nORDER BY Comparison, Version",
          "width": 8,
          "height": 3,
          "x": 0,
          "y": 2,
          "type": "table",
          "selection": {},
          "settings": {
            "transposed": true,
            "compact": true,
            "wrapContent": true
          }
        },
        {
          "id": "e339740a-6578-4479-b37b-4fb37c0a2356",
          "title": "CRF Attributes differences - $neodash_odmstudyeventvalue_name",
          "query": "WITH [\n  {id: $neodash_coll_base_id, version: $neodash_coll_base_version_num, label: 'Base'},\n  {id: $neodash_coll_comp_id, version: $neodash_coll_comp_version_num, label: 'Compare'}\n] AS selections\n\nUNWIND selections AS selection\n\nMATCH (coll_root:OdmStudyEventRoot)-[coll_version:HAS_VERSION]->(coll:OdmStudyEventValue)\nWHERE elementId(coll) = selection.id \n  AND coll_version.version = selection.version\nOPTIONAL MATCH\n  (coll)-[r1_1:FORM_REF]->\n  (form:OdmFormValue)<-[form_version:HAS_VERSION]-\n  (form_root:OdmFormRoot)\nOPTIONAL MATCH (form)-[r1_2:HAS_DESCRIPTION]->(form_desc:OdmDescription)\nOPTIONAL MATCH (form)-[r1_3:HAS_ALIAS]->(form_alias:OdmAlias)\nOPTIONAL MATCH (form)-[r1_4:HAS_VENDOR_ELEMENT]->(f_ext_elem:OdmVendorElementValue)<-[r1_5:HAS_VENDOR_ELEMENT]-(f_elem_vendor_ns:OdmVendorNamespaceValue)<-[f_elem_vendor_ns_version:HAS_VERSION]-(),(f_ext_elem)<-[f_ext_elem_version:HAS_VERSION]-()\nOPTIONAL MATCH (form)-[r1_6:HAS_VENDOR_ATTRIBUTE]->(f_ext_att:OdmVendorAttributeValue)<-[r1_7:HAS_VENDOR_ATTRIBUTE]-(f_att_vendor_ns:OdmVendorNamespaceValue)<-[f_att_vendor_ns_version:HAS_VERSION]-(),(f_ext_att)<-[f_ext_att_version:HAS_VERSION]-()\nWITH DISTINCT\n  selection.label as collection,\n  coll_version,\n  form,\n  CASE\n    WHEN\n      form_alias IS NOT NULL\n      THEN\n        apoc.map.fromPairs(\n          [\n            key IN keys(properties(form_alias))\n            | [\"alias-\" + key, properties(form_alias)[key]]\n          ])\n    ELSE {}\n  END AS aliasMap,\n  CASE\n    WHEN\n      form_desc IS NOT NULL\n      THEN\n        apoc.map.fromPairs(\n          [\n            key IN keys(properties(form_desc))\n            | [\"desc-\" + key, properties(form_desc)[key]]\n          ])\n    ELSE {}\n  END AS descMap,\n  CASE\n  WHEN f_ext_elem IS NOT NULL AND f_ext_elem_version IS NOT NULL\n    THEN apoc.map.fromPairs([key IN keys(properties(f_ext_elem)) | [\"elemExt-\" + key, properties(f_ext_elem)[key]+'(V'+f_ext_elem_version.version+')']])\n  ELSE {}\nEND AS f_ext_elemMap,\nCASE\n  WHEN f_ext_att IS NOT NULL AND f_ext_att_version IS NOT NULL\n    THEN apoc.map.fromPairs([key IN keys(properties(f_ext_att)) | [\"attExt-\" + key, properties(f_ext_att)[key]+'(V'+f_ext_att_version.version+')']])\n  ELSE {}\nEND AS f_ext_attMap,\nCASE\n  WHEN f_elem_vendor_ns IS NOT NULL AND f_elem_vendor_ns_version IS NOT NULL\n    THEN apoc.map.fromPairs([key IN keys(properties(f_elem_vendor_ns)) | [\"elem_nsExt-\" + key, properties(f_elem_vendor_ns)[key]+'(V'+f_elem_vendor_ns_version.version+')']])\n  ELSE {}\nEND AS f_elem_vendor_nsMap,\nCASE\n  WHEN f_att_vendor_ns IS NOT NULL AND f_att_vendor_ns_version IS NOT NULL\n    THEN apoc.map.fromPairs([key IN keys(properties(f_att_vendor_ns)) | [\"att_nsExt-\" + key, properties(f_att_vendor_ns)[key]+'(V'+f_att_vendor_ns_version.version+')']])\n  ELSE {}\nEND AS f_att_vendor_nsMap,\n  coalesce(properties(form), {}) AS formMap\nWITH\n  collection,\n  coll_version,\n  form,\n apoc.map.mergeList([formMap, descMap, aliasMap, f_att_vendor_nsMap, f_elem_vendor_nsMap, f_ext_attMap, f_ext_elemMap]) AS props_map\nUNWIND keys(props_map) AS field\nWITH\n  form.oid AS OID,\n  field,\n  apoc.map.fromPairs(collect([collection, props_map[field]])) AS value_map\nWITH\n  OID AS `CRF OID`,\n  CASE split(field, '-')[0]\n  WHEN 'elem_nsExt' THEN '7ElementVendorExtNameSpace'\n  WHEN 'elemExt' THEN '6ElementVendorExt'\n  WHEN 'att_nsExt' THEN '5AttributeVendorExtNameSpace'\n  WHEN 'attExt' THEN '4AttributeVendorExt'\n  WHEN 'desc' THEN '2Description'\n  WHEN 'alias' THEN '3Alias'\n  ELSE '1Identification'\nEND AS area,\n  CASE WHEN split(field, '-')[0] IN ['desc', 'alias', 'attExt','elemExt','elem_nsExt','att_nsExt'] \n     THEN split(field, '-')[1]  \n     ELSE field \nEND AS `CRF attribute`,  \n  replace(replace(toString(value_map['Base']), '<p>', ''), '</p>', '')   AS Base,\n  replace(replace(toString(value_map['Compare']), '<p>', ''), '</p>', '')  AS Compare\nORDER BY `CRF OID`, area, `CRF attribute`\nWITH `CRF OID`,area, `CRF attribute`, Base, Compare, \nCASE WHEN Base = Compare THEN 'N' ELSE CASE WHEN Base is null and Compare is null THEN 'N' ELSE 'Y' END END as __diff,\nCASE \n    WHEN Base = Compare THEN 'âšª No Changes'\n    WHEN Base IS NULL THEN 'âœ… Added'\n    WHEN Compare IS NULL THEN 'âŒ Removed'\n    ELSE 'ðŸ”„ Modified'\nEND AS `Change Type`\nRETURN `CRF OID`, substring(area,1) as Area, `CRF attribute`, Base, Compare, `Change Type`, __diff",
          "width": 17,
          "height": 4,
          "x": 7,
          "y": 5,
          "type": "table",
          "selection": {},
          "settings": {
            "transposed": false,
            "compact": true,
            "wrapContent": true,
            "columnWidths": "[1,1,1,2,2]",
            "styleRules": [
              {
                "field": "__diff",
                "condition": "contains",
                "value": "Y",
                "customization": "row color",
                "customizationValue": "#FF11116E",
                "targetField": "Base"
              },
              {
                "field": "__diff",
                "condition": "contains",
                "value": "N",
                "customization": "row color",
                "customizationValue": "#5FE8866E ",
                "targetField": "Base"
              }
            ],
            "refreshButtonEnabled": true,
            "fullscreenEnabled": true,
            "allowDownload": true,
            "noDataMessage": "Select Base and Compare above"
          }
        },
        {
          "id": "ee5da3de-7905-48dc-a917-500560efde92",
          "title": "CRF count",
          "query": "WITH [\n  {id: $neodash_coll_base_id, version: $neodash_coll_base_version_num, label: 'Base'},\n  {id: $neodash_coll_comp_id, version: $neodash_coll_comp_version_num, label: 'Compare'}\n] AS selections\nUNWIND selections AS selection\nMATCH (coll_root:OdmStudyEventRoot)-[coll_version:HAS_VERSION]->(coll:OdmStudyEventValue)\nWHERE elementId(coll) = selection.id \n  AND coll_version.version = selection.version\nOPTIONAL MATCH p=(coll)-[:FORM_REF]->(form:OdmFormValue)\nRETURN selection.label+'-V'+toString(coll_version.version) AS version, \n       toInteger(COUNT(DISTINCT form)) AS `Form count`,\n       'FORM_COUNT' AS metric_type",
          "width": 7,
          "height": 4,
          "x": 0,
          "y": 5,
          "type": "bar",
          "selection": {
            "index": "version",
            "value": "Form count",
            "key": "(none)"
          },
          "settings": {
            "showOptionalSelections": false,
            "minValue": 0,
            "layout": "vertical",
            "groupMode": "stacked",
            "barValues": true,
            "legend": false,
            "displayYAxis": false,
            "positionLabel": "off",
            "customDimensions": false,
            "colors": "set1",
            "labelRotation": 0,
            "marginBottom": 40,
            "expandHeightForLegend": false,
            "innerPadding": 10,
            "hideSelections": true
          },
          "schema": []
        },
        {
          "id": "ac7c0d08-ca16-4559-827c-bcadcc4adc7a",
          "title": "CRF",
          "query": "MATCH\n  (coll_root:OdmStudyEventRoot)-[coll_version:HAS_VERSION]->\n  (coll:OdmStudyEventValue)\nWHERE elementId(coll) IN [$neodash_coll_base_id, $neodash_coll_comp_id]\nOPTIONAL MATCH (coll)-[:FORM_REF]->(form:OdmFormValue)\nWHERE toLower(toString(form.`oid`)) CONTAINS toLower($input) \nRETURN DISTINCT form.`oid` as value,  form.`name` as display ORDER BY size(toString(value)) ASC LIMIT 100\n",
          "width": 7,
          "height": 2,
          "x": 0,
          "y": 9,
          "type": "select",
          "selection": {},
          "settings": {
            "type": "Custom Query",
            "entityType": "select CRF",
            "parameterName": "neodash_select_crf"
          },
          "schema": []
        },
        {
          "id": "abe0ee33-ff8d-4649-bc8c-3b6970093232",
          "title": "Group count - $neodash_select_crf",
          "query": "WITH [\n  {id: $neodash_coll_base_id, version: $neodash_coll_base_version_num, label: 'Base'},\n  {id: $neodash_coll_comp_id, version: $neodash_coll_comp_version_num, label: 'Compare'}\n] AS selections\nUNWIND selections AS selection\nMATCH (coll_root:OdmStudyEventRoot)-[coll_version:HAS_VERSION]->(coll:OdmStudyEventValue)\nWHERE elementId(coll) = selection.id \n  AND coll_version.version = selection.version\nOPTIONAL MATCH (coll)-[:FORM_REF]->(form:OdmFormValue) where form.oid=$neodash_select_crf\nOPTIONAL MATCH (form)-[:ITEM_GROUP_REF]->(group:OdmItemGroupValue)\nRETURN selection.label+'-V'+toString(coll_version.version) AS version,\n        toInteger(COUNT(DISTINCT group)) AS `Group count`,\n        'GROUP_COUNT' AS metric_type",
          "width": 7,
          "height": 4,
          "x": 0,
          "y": 11,
          "type": "bar",
          "selection": {
            "index": "version",
            "value": "Group count",
            "key": "(none)"
          },
          "settings": {
            "showOptionalSelections": false,
            "minValue": 0,
            "layout": "vertical",
            "groupMode": "stacked",
            "barValues": true,
            "legend": false,
            "displayYAxis": false,
            "positionLabel": "off",
            "customDimensions": false,
            "colors": "nivo",
            "labelRotation": 0,
            "marginBottom": 40,
            "expandHeightForLegend": false,
            "innerPadding": 10,
            "hideSelections": true
          },
          "schema": []
        },
        {
          "id": "9789ad0f-e5aa-4a70-b1df-a03648d56c3b",
          "title": "Group in $neodash_select_crf",
          "query": "MATCH\n  (coll_root:OdmStudyEventRoot)-[coll_version:HAS_VERSION]->\n  (coll:OdmStudyEventValue)\nWHERE elementId(coll) IN [$neodash_coll_base_id, $neodash_coll_comp_id]\nOPTIONAL MATCH (coll)-[:FORM_REF]->(form:OdmFormValue) where form.oid=$neodash_select_crf\nOPTIONAL MATCH (form)-[:ITEM_GROUP_REF]->(group:OdmItemGroupValue)\nWHERE toLower(toString(group.`oid`)) CONTAINS toLower($input) \nRETURN DISTINCT group.`oid` as value,  group.`name` as display ORDER BY size(toString(value)) ASC LIMIT 100\n\n\n\n",
          "width": 7,
          "height": 2,
          "x": 0,
          "y": 15,
          "type": "select",
          "selection": {},
          "settings": {
            "type": "Custom Query",
            "entityType": "select Group",
            "parameterName": "neodash_select_group"
          },
          "schema": []
        },
        {
          "id": "133d57ec-6bee-4e76-bed0-963721665124",
          "title": "Item count - $neodash_select_group",
          "query": "WITH [\n  {id: $neodash_coll_base_id, version: $neodash_coll_base_version_num, label: 'Base'},\n  {id: $neodash_coll_comp_id, version: $neodash_coll_comp_version_num, label: 'Compare'}\n] AS selections\nUNWIND selections AS selection\nMATCH (coll_root:OdmStudyEventRoot)-[coll_version:HAS_VERSION]->(coll:OdmStudyEventValue)\nWHERE elementId(coll) = selection.id \n  AND coll_version.version = selection.version\nOPTIONAL MATCH (coll)-[:FORM_REF]->(form:OdmFormValue) where form.oid=$neodash_select_crf\nOPTIONAL MATCH (form)-[:ITEM_GROUP_REF]->(group:OdmItemGroupValue) where group.oid=$neodash_select_group\nOPTIONAL MATCH (group)-[:ITEM_REF]->(item:OdmItemValue)\nRETURN selection.label+'-V'+toString(coll_version.version) AS version,\n       toInteger(COUNT(DISTINCT item)) AS `Item count`,\n       'ITEM_COUNT' AS metric_type\nORDER BY version",
          "width": 7,
          "height": 4,
          "x": 0,
          "y": 17,
          "type": "bar",
          "selection": {
            "index": "version",
            "value": "Item count",
            "key": "(none)"
          },
          "settings": {
            "showOptionalSelections": false,
            "minValue": 0,
            "layout": "vertical",
            "groupMode": "stacked",
            "barValues": true,
            "legend": false,
            "displayYAxis": false,
            "positionLabel": "off",
            "customDimensions": false,
            "colors": "category10",
            "labelRotation": 0,
            "marginBottom": 40,
            "expandHeightForLegend": false,
            "innerPadding": 10,
            "hideSelections": true
          },
          "schema": []
        },
        {
          "id": "8af7298a-8e94-45c5-98c3-82b881d462dc",
          "title": "Group Attributes differences - $neodash_select_crf",
          "query": "WITH [\n  {id: $neodash_coll_base_id, version: $neodash_coll_base_version_num, label: 'Base'},\n  {id: $neodash_coll_comp_id, version: $neodash_coll_comp_version_num, label: 'Compare'}\n] AS selections\nUNWIND selections AS selection\nMATCH (coll_root:OdmStudyEventRoot)-[coll_version:HAS_VERSION]->(coll:OdmStudyEventValue)\nWHERE elementId(coll) = selection.id \n  AND coll_version.version = selection.version\n//Get form and its details\noptional match(coll)-[r1_1:FORM_REF]->(form:OdmFormValue) where form.oid=$neodash_select_crf\n// create the structure for comparing group details\n//Get the groups in the form and the group details\noptional match(form)-[r1_4:ITEM_GROUP_REF]->(group:OdmItemGroupValue)<-[group_version:HAS_VERSION]-(group_root:OdmItemGroupRoot)\noptional match(group)-[r2_1:HAS_DESCRIPTION]->(group_desc:OdmDescription)\noptional match(group)-[r2_2:HAS_ALIAS]->(group_alias:OdmAlias)\noptional match(group)-[r2_3:HAS_SDTM_DOMAIN]->(g_context:CTTermContext)-[r2_4:HAS_SELECTED_TERM]->(g_term_root:CTTermRoot)<-[r2_5:HAS_TERM_ROOT]-(domain:CTCodelistTerm)\noptional match(group)-[r2_6:HAS_VENDOR_ELEMENT]->(g_ext_elem:OdmVendorElementValue)<-[r2_7:HAS_VENDOR_ELEMENT]-(g_elem_vendor_ns:OdmVendorNamespaceValue)<-[g_elem_vendor_ns_version:HAS_VERSION]-(),(g_ext_elem)<-[g_ext_elem_version:HAS_VERSION]-()\noptional match(group)-[r2_8:HAS_VENDOR_ATTRIBUTE]->(g_ext_att:OdmVendorAttributeValue)<-[r2_9:HAS_VENDOR_ATTRIBUTE]-(g_att_vendor_ns:OdmVendorNamespaceValue)<-[g_att_vendor_ns_version:HAS_VERSION]-(),(g_ext_att)<-[g_ext_att_version:HAS_VERSION]-()\nWITH DISTINCT\n  selection.label as collection,\n  coll_version,\n  form,\n  group,\n  CASE\n    WHEN\n      group_alias IS NOT NULL\n      THEN\n        apoc.map.fromPairs(\n          [\n            key IN keys(properties(group_alias))\n            | [\"alias-\" + key, properties(group_alias)[key]]\n          ])\n    ELSE {}\n  END AS aliasMap,\n  CASE\n    WHEN\n      group_desc IS NOT NULL\n      THEN\n        apoc.map.fromPairs(\n          [\n            key IN keys(properties(group_desc))\n            | [\"desc-\" + key, properties(group_desc)[key]]\n          ])\n    ELSE {}\n  END AS descMap,\n  // Domain map\n    CASE\n    WHEN\n      domain IS NOT NULL\n      THEN\n        apoc.map.fromPairs(\n          [\n            key IN keys(properties(domain))\n            | [\"domain-\" + key, properties(domain)[key]]\n          ])\n    ELSE {}\n  END AS domainMap,\n  CASE\n  WHEN g_ext_elem IS NOT NULL AND g_ext_elem_version IS NOT NULL\n    THEN apoc.map.fromPairs([key IN keys(properties(g_ext_elem)) | [\"elemExt-\" + key, properties(g_ext_elem)[key]+'(V'+g_ext_elem_version.version+')']])\n  ELSE {}\nEND AS g_ext_elemMap,\nCASE\n  WHEN g_ext_att IS NOT NULL AND g_ext_att_version IS NOT NULL\n    THEN apoc.map.fromPairs([key IN keys(properties(g_ext_att)) | [\"attExt-\" + key, properties(g_ext_att)[key]+'(V'+g_ext_att_version.version+')']])\n  ELSE {}\nEND AS g_ext_attMap,\nCASE\n  WHEN g_elem_vendor_ns IS NOT NULL AND g_elem_vendor_ns_version IS NOT NULL\n    THEN apoc.map.fromPairs([key IN keys(properties(g_elem_vendor_ns)) | [\"elem_nsExt-\" + key, properties(g_elem_vendor_ns)[key]+'(V'+g_elem_vendor_ns_version.version+')']])\n  ELSE {}\nEND AS g_elem_vendor_nsMap,\nCASE\n  WHEN g_att_vendor_ns IS NOT NULL AND g_att_vendor_ns_version IS NOT NULL\n    THEN apoc.map.fromPairs([key IN keys(properties(g_att_vendor_ns)) | [\"att_nsExt-\" + key, properties(g_att_vendor_ns)[key]+'(V'+g_att_vendor_ns_version.version+')']])\n  ELSE {}\nEND AS g_att_vendor_nsMap,\n  coalesce(properties(group), {}) AS groupMap\nWITH\n  collection,\n  coll_version,\n  form,\n  group,\n apoc.map.mergeList([groupMap, descMap, aliasMap, domainMap, g_att_vendor_nsMap, g_elem_vendor_nsMap, g_ext_attMap, g_ext_elemMap]) AS props_map\nUNWIND keys(props_map) AS field\nWITH DISTINCT\n  form.oid AS fOID,\n  group.oid as gOID,\n  field,\n  apoc.map.fromPairs(collect([collection, props_map[field]])) AS value_map\nWITH DISTINCT\n  fOID AS `CRF OID`,\n  gOID as `Group OID`,\n  CASE split(field, '-')[0]\n  WHEN 'elem_nsExt' THEN '8ElementVendorExtNameSpace'\n  WHEN 'elemExt' THEN '7ElementVendorExt'\n  WHEN 'att_nsExt' THEN '6AttributeVendorExtNameSpace'\n  WHEN 'attExt' THEN '5AttributeVendorExt'\n  WHEN 'domain' THEN '4Domain'\n  WHEN 'alias' THEN '3Alias'\n  WHEN 'desc' THEN '2Description'\n  ELSE '1Identification'\nEND AS area,\n  CASE WHEN split(field, '-')[0] IN ['desc', 'alias', 'domain', 'attExt','elemExt','elem_nsExt','att_nsExt'] \n     THEN split(field, '-')[1]  \n     ELSE field \nEND AS `Group attribute`,  \n  replace(replace(toString(value_map['Base']), '<p>', ''), '</p>', '')   AS Base,\n  replace(replace(toString(value_map['Compare']), '<p>', ''), '</p>', '')  AS Compare\nORDER BY `CRF OID`, `Group OID`, area, `Group attribute`\nWITH DISTINCT `CRF OID`,`Group OID`, area, `Group attribute`, Base, Compare, \nCASE WHEN Base = Compare THEN 'N' ELSE CASE WHEN Base is null and Compare is null THEN 'N' ELSE 'Y' END END as __diff,\nCASE \n    WHEN Base = Compare THEN 'âšª No Changes'\n    WHEN Base IS NULL THEN 'âœ… Added'\n    WHEN Compare IS NULL THEN 'âŒ Removed'\n    ELSE 'ðŸ”„ Modified'\nEND AS `Change Type`\nWITH DISTINCT `Group OID`,substring(area,1) as Area, `Group attribute`, Base, Compare, `Change Type`, __diff\n// Collect all results into a list\nWITH collect({\n  `Group OID`: `Group OID`,\n  Area: Area,\n  `Group attribute`: `Group attribute`,\n  Base: Base,\n  Compare: Compare,\n  `Change Type`: `Change Type`,\n  __diff: __diff\n}) AS results\n// If empty, return message row; otherwise return actual results\nUNWIND CASE \n  WHEN size(results) = 0 and not $neodash_select_crf =\"\" THEN [{\n    `Group OID`: 'No Groups in the Form',\n    Area: null,\n    `Group attribute`: null,\n    Base: null,\n    Compare: null,\n    `Change Type`: null,\n    __diff: null\n  }]\n  ELSE results\nEND AS row\nRETURN row.`Group OID` AS `Group OID`, \n       row.Area AS Area, \n       row.`Group attribute` AS `Group attribute`, \n       row.Base AS Base, \n       row.Compare AS Compare, \n       row.`Change Type` AS `Change Type`,\n       row.__diff AS __diff",
          "width": 17,
          "height": 6,
          "x": 7,
          "y": 9,
          "type": "table",
          "selection": {},
          "settings": {
            "transposed": false,
            "compact": true,
            "wrapContent": true,
            "columnWidths": "[1,1,1,2,2]",
            "styleRules": [
              {
                "field": "__diff",
                "condition": "contains",
                "value": "Y",
                "customization": "row color",
                "customizationValue": "#FF11116E",
                "targetField": "Base"
              },
              {
                "field": "__diff",
                "condition": "contains",
                "value": "N",
                "customization": "row color",
                "customizationValue": "#5FE8866E ",
                "targetField": "Base"
              }
            ],
            "fullscreenEnabled": true,
            "allowDownload": true,
            "noDataMessage": "Select CRF in the drop-down to the left"
          }
        },
        {
          "id": "5e28f83f-b488-4bee-9d65-9342dac36f84",
          "title": "Item Attributes differences - $neodash_select_group",
          "query": "WITH [\n  {id: $neodash_coll_base_id, version: $neodash_coll_base_version_num, label: 'Base'},\n  {id: $neodash_coll_comp_id, version: $neodash_coll_comp_version_num, label: 'Compare'}\n] AS selections\nUNWIND selections AS selection\nMATCH (coll_root:OdmStudyEventRoot)-[coll_version:HAS_VERSION]->(coll:OdmStudyEventValue)\nWHERE elementId(coll) = selection.id \n  AND coll_version.version = selection.version\n//Get form and its details\noptional match(coll)-[r1_1:FORM_REF]->(form:OdmFormValue) where form.oid=$neodash_select_crf\noptional match(form)-[r1_4:ITEM_GROUP_REF]->(group:OdmItemGroupValue) where group.oid=$neodash_select_group\n  //Get the item in the group on the form and the item details\noptional match(group)-[r3_1:ITEM_REF]->(item:OdmItemValue)<-[item_version:HAS_VERSION]-(item_root:OdmItemRoot)\noptional match(item)-[r3_2:HAS_DESCRIPTION]->(item_desc:OdmDescription)\noptional match(item)-[r3_3:HAS_ALIAS]->(item_alias:OdmAlias)\noptional match(item)-[r3_4:HAS_CODELIST_TERM]->(i_context:CTTermContext)-[r3_5:HAS_SELECTED_TERM]->(i_term_root:CTTermRoot)<-[r3_6:HAS_TERM_ROOT]-(item_term:CTCodelistTerm)\noptional match(item)-[r3_7:HAS_VENDOR_ELEMENT]->(i_ext_elem:OdmVendorElementValue)<-[r3_8:HAS_VENDOR_ELEMENT]-(i_elem_vendor_ns:OdmVendorNamespaceValue)<-[i_elem_vendor_ns_version:HAS_VERSION]-(),(i_ext_elem)<-[i_ext_elem_version:HAS_VERSION]-()\noptional match(item)-[r3_9:HAS_VENDOR_ATTRIBUTE]->(i_ext_att:OdmVendorAttributeValue)<-[r3_10:HAS_VENDOR_ATTRIBUTE]-(i_att_vendor_ns:OdmVendorNamespaceValue)<-[i_att_vendor_ns_version:HAS_VERSION]-(),(i_ext_att)<-[i_ext_att_version:HAS_VERSION]-()\nWITH DISTINCT\n  selection.label as collection,\n  coll_version,\n  form,\n  group,\n  item,\n  CASE\n    WHEN\n      item_alias IS NOT NULL\n      THEN\n        apoc.map.fromPairs(\n          [\n            key IN keys(properties(item_alias))\n            | [\"alias-\" + key, properties(item_alias)[key]]\n          ])\n    ELSE {}\n  END AS aliasMap,\n  CASE\n    WHEN\n      item_desc IS NOT NULL\n      THEN\n        apoc.map.fromPairs(\n          [\n            key IN keys(properties(item_desc))\n            | [\"desc-\" + key, properties(item_desc)[key]]\n          ])\n    ELSE {}\n  END AS descMap,\n  // Domain map\n    CASE\n    WHEN\n      item_term IS NOT NULL\n      THEN\n        apoc.map.fromPairs(\n          [\n            key IN keys(properties(item_term))\n            | [\"itemterm-\" + key, properties(item_term)[key]]\n          ])\n    ELSE null\n  END AS itemTermMap,\nCASE\n  WHEN i_ext_elem IS NOT NULL AND i_ext_elem_version IS NOT NULL\n    THEN apoc.map.fromPairs([key IN keys(properties(i_ext_elem)) | [\"elemExt-\" + key, properties(i_ext_elem)[key]+'(V'+i_ext_elem_version.version+')']])\n  ELSE {}\nEND AS i_ext_elemMap,\n\nCASE\n  WHEN i_ext_att IS NOT NULL AND i_ext_att_version IS NOT NULL\n    THEN apoc.map.fromPairs([key IN keys(properties(i_ext_att)) | [\"attExt-\" + key, properties(i_ext_att)[key]+'(V'+i_ext_att_version.version+')']])\n  ELSE {}\nEND AS i_ext_attMap,\n\nCASE\n  WHEN i_elem_vendor_ns IS NOT NULL AND i_elem_vendor_ns_version IS NOT NULL\n    THEN apoc.map.fromPairs([key IN keys(properties(i_elem_vendor_ns)) | [\"elem_nsExt-\" + key, properties(i_elem_vendor_ns)[key]+'(V'+i_elem_vendor_ns_version.version+')']])\n  ELSE {}\nEND AS i_elem_vendor_nsMap,\n\nCASE\n  WHEN i_att_vendor_ns IS NOT NULL AND i_att_vendor_ns_version IS NOT NULL\n    THEN apoc.map.fromPairs([key IN keys(properties(i_att_vendor_ns)) | [\"att_nsExt-\" + key, properties(i_att_vendor_ns)[key]+'(V'+i_att_vendor_ns_version.version+')']])\n  ELSE {}\nEND AS i_att_vendor_nsMap,\n  coalesce(properties(item), {}) AS itemMap\nWITH \n  collection,\n  coll_version,\n  form,\n  group,\n  item,\n  itemMap,\n  descMap,\n  aliasMap,\n  i_ext_elemMap,\n  i_ext_attMap,\n  i_elem_vendor_nsMap,\n  i_att_vendor_nsMap,\n  collect(itemTermMap) as itemTermMaps\nWITH \n  collection,\n  coll_version,\n  form,\n  group,\n  item,\n  itemMap,\n  descMap,\n  aliasMap,\n  i_ext_elemMap,\n  i_ext_attMap,\n  i_elem_vendor_nsMap,\n  i_att_vendor_nsMap,\n  CASE WHEN size(itemTermMaps)>0 THEN {`itemterm-submission_value`: apoc.text.join([map IN itemTermMaps WHERE size(keys(map))>0 | map.`itemterm-submission_value`], \";\")} ELSE {} END AS itemTermMap\nWITH collection,\n  coll_version,\n  form,\n  group,\n  item,\n  apoc.map.mergeList([itemMap, descMap, aliasMap, itemTermMap, i_att_vendor_nsMap, i_elem_vendor_nsMap, i_ext_attMap, i_ext_elemMap]) AS props_map\nUNWIND keys(props_map) AS field\nWITH DISTINCT\n  form.oid AS fOID,\n  group.oid as gOID,\n  item.oid as iOID,\n  field,\n  apoc.map.fromPairs(collect([collection, props_map[field]])) AS value_map\nWITH DISTINCT\n  fOID AS `CRF OID`,\n  gOID as `Group OID`,\n  iOID as `Item OID`,\n  CASE split(field, '-')[0]\n  WHEN 'elem_nsExt' THEN '8ElementVendorExtNameSpace'\n  WHEN 'elemExt' THEN '7ElementVendorExt'\n  WHEN 'att_nsExt' THEN '6AttributeVendorExtNameSpace'\n  WHEN 'attExt' THEN '5AttributeVendorExt'\n  WHEN 'itemterm' THEN '4Terms'\n  WHEN 'alias' THEN '3Alias'\n  WHEN 'desc' THEN '2Description'\n  ELSE '1Identification'\nEND AS area,\n  CASE WHEN split(field, '-')[0] IN ['desc', 'alias', 'itemterm', 'attExt','elemExt','elem_nsExt','att_nsExt'] \n     THEN split(field, '-')[1]  \n     ELSE field \nEND AS `Item attribute`,\nreplace(replace(toString(value_map['Base']), '<p>', ''), '</p>', '')   AS Base,\nreplace(replace(toString(value_map['Compare']), '<p>', ''), '</p>', '')  AS Compare\nORDER BY `CRF OID`, `Group OID`, `Item OID`, area, `Item attribute`\nWITH DISTINCT `CRF OID`,`Group OID`, `Item OID`, area, `Item attribute`, Base, Compare, \nCASE WHEN Base = Compare THEN 'N' ELSE CASE WHEN Base is null and Compare is null THEN 'N' ELSE 'Y' END END as __diff,\nCASE \n    WHEN Base = Compare THEN 'âšª No Changes'\n    WHEN Base IS NULL THEN 'âœ… Added'\n    WHEN Compare IS NULL THEN 'âŒ Removed'\n    ELSE 'ðŸ”„ Modified'\nEND AS `Change Type`\nWITH DISTINCT `Item OID`, substring(area,1) as Area, `Item attribute`, Base, Compare, `Change Type`, __diff\n// Collect all results into a list\nWITH collect({\n  `Item OID`: `Item OID`,\n  Area: Area,\n  `Item attribute`: `Item attribute`,\n  Base: Base,\n  Compare: Compare,\n  `Change Type`: `Change Type`,\n  __diff: __diff\n}) AS results\n// If empty, return message row; otherwise return actual results\nUNWIND CASE \n  WHEN size(results) = 0 AND NOT $neodash_select_group = \"\" THEN [{\n    `Item OID`: 'No Items in the Group',\n    Area: null,\n    `Item attribute`: null,\n    Base: null,\n    Compare: null,\n    `Change Type`: null,\n    __diff: null\n  }]\n  ELSE results\nEND AS row\nRETURN row.`Item OID` AS `Item OID`, \n       row.Area AS Area, \n       row.`Item attribute` AS `Item attribute`, \n       row.Base AS Base, \n       row.Compare AS Compare, \n       row.`Change Type` AS `Change Type`,\n       row.__diff AS __diff",
          "width": 17,
          "height": 6,
          "x": 7,
          "y": 15,
          "type": "table",
          "selection": {},
          "settings": {
            "transposed": false,
            "compact": true,
            "wrapContent": true,
            "columnWidths": "[1,1,1,2,2]",
            "styleRules": [
              {
                "field": "__diff",
                "condition": "contains",
                "value": "Y",
                "customization": "row color",
                "customizationValue": "#FF11116E",
                "targetField": "Base"
              },
              {
                "field": "__diff",
                "condition": "contains",
                "value": "N",
                "customization": "row color",
                "customizationValue": "#5FE8866E ",
                "targetField": "Base"
              }
            ],
            "refreshButtonEnabled": true,
            "fullscreenEnabled": true,
            "allowDownload": true,
            "noDataMessage": "Select Group in the drop-down to the left"
          }
        }
      ]
    },
    {
      "title": "Collection release Notes",
      "reports": [
        {
          "id": "51b7df6b-463e-4447-b82b-58cbaa8d049e",
          "title": "$neodash_odmstudyeventvalue_name - Release Notes( v $neodash_coll_base_version_num â†’ v $neodash_coll_comp_version_num)",
          "query": "WITH [\n  {id: $neodash_coll_base_id, version: $neodash_coll_base_version_num, label: 'Base'},\n  {id: $neodash_coll_comp_id, version: $neodash_coll_comp_version_num, label: 'Compare'}\n] AS selections\n\nUNWIND selections AS selection\n\nMATCH (coll_root:OdmStudyEventRoot)-[coll_version:HAS_VERSION]->(coll:OdmStudyEventValue)\nWHERE elementId(coll) = selection.id AND coll_version.version = selection.version\n\nOPTIONAL MATCH (coll)-[:FORM_REF]->(form:OdmFormValue) \nWHERE form.oid = $neodash_crf_in_collection OR $neodash_crf_in_collection=''\nOPTIONAL MATCH (form)-[:HAS_DESCRIPTION]->(form_desc:OdmDescription)\nOPTIONAL MATCH (form)-[:HAS_ALIAS]->(form_alias:OdmAlias)\nOPTIONAL MATCH (form)-[:ITEM_GROUP_REF]->(group:OdmItemGroupValue)\nOPTIONAL MATCH (group)-[:HAS_DESCRIPTION]->(group_desc:OdmDescription)\nOPTIONAL MATCH (group)-[:HAS_ALIAS]->(group_alias:OdmAlias)\nOPTIONAL MATCH (group)-[:ITEM_REF]->(item:OdmItemValue)\nOPTIONAL MATCH (item)-[:HAS_DESCRIPTION]->(item_desc:OdmDescription)\nOPTIONAL MATCH (item)-[:HAS_ALIAS]->(item_alias:OdmAlias)\n\nWITH selection.label as collection,\n     form, form.oid as form_oid,\n     group, group.oid as group_oid,\n     item, item.oid as item_oid,\n     apoc.map.mergeList([\n       coalesce(properties(form), {}),\n       CASE WHEN form_desc IS NOT NULL THEN apoc.map.fromPairs([key IN keys(properties(form_desc)) | [\"desc-\" + key, properties(form_desc)[key]]]) ELSE {} END,\n       CASE WHEN form_alias IS NOT NULL THEN apoc.map.fromPairs([key IN keys(properties(form_alias)) | [\"alias-\" + key, properties(form_alias)[key]]]) ELSE {} END\n     ]) AS form_props,\n     apoc.map.mergeList([\n       coalesce(properties(group), {}),\n       CASE WHEN group_desc IS NOT NULL THEN apoc.map.fromPairs([key IN keys(properties(group_desc)) | [\"desc-\" + key, properties(group_desc)[key]]]) ELSE {} END,\n       CASE WHEN group_alias IS NOT NULL THEN apoc.map.fromPairs([key IN keys(properties(group_alias)) | [\"alias-\" + key, properties(group_alias)[key]]]) ELSE {} END\n     ]) AS group_props,\n     apoc.map.mergeList([\n       coalesce(properties(item), {}),\n       CASE WHEN item_desc IS NOT NULL THEN apoc.map.fromPairs([key IN keys(properties(item_desc)) | [\"desc-\" + key, properties(item_desc)[key]]]) ELSE {} END,\n       CASE WHEN item_alias IS NOT NULL THEN apoc.map.fromPairs([key IN keys(properties(item_alias)) | [\"alias-\" + key, properties(item_alias)[key]]]) ELSE {} END\n     ]) AS item_props\n\nWITH collection, form_oid, group_oid, item_oid,\n     CASE WHEN form IS NOT NULL THEN [{level: 'CRF', oid: form_oid, group_oid: null, form_oid: form_oid, props: form_props}] ELSE [] END +\n     CASE WHEN group IS NOT NULL THEN [{level: 'Group', oid: group_oid, group_oid: group_oid, form_oid: form_oid, props: group_props}] ELSE [] END +\n     CASE WHEN item IS NOT NULL THEN [{level: 'Item', oid: item_oid, group_oid: group_oid, form_oid: form_oid, props: item_props}] ELSE [] END AS all_levels\n\nUNWIND all_levels AS level_data\n\nWITH collection, \n     level_data.level as level, \n     level_data.oid as oid, \n     level_data.form_oid as form_oid,\n     level_data.group_oid as group_oid,\n     level_data.props as props\n\nUNWIND keys(props) AS field\n\nWITH level, oid, form_oid, group_oid, field,\n  apoc.map.fromPairs(collect([collection, props[field]])) AS value_map\n\nWITH level, oid, form_oid, group_oid, field,\n  replace(replace(toString(value_map['Base']), '<p>', ''), '</p>', '') AS Base,\n  replace(replace(toString(value_map['Compare']), '<p>', ''), '</p>', '') AS Compare\n\n// Collect all forms and identify which have changes\nWITH collect({\n       level: level, \n       oid: oid, \n       form_oid: form_oid, \n       group_oid: group_oid, \n       field: field, \n       Base: Base, \n       Compare: Compare,\n       has_change: (Base <> Compare OR (Base IS NULL AND Compare IS NOT NULL) OR (Base IS NOT NULL AND Compare IS NULL))\n     }) as all_data\n\n// Get list of forms with at least one change\nWITH all_data,\n     apoc.coll.toSet([d IN all_data WHERE d.has_change = true | d.form_oid]) as forms_with_changes,\n     apoc.coll.toSet([d IN all_data | d.form_oid]) as all_forms\n\n// Find forms with no changes\nWITH all_data, forms_with_changes,\n     [f IN all_forms WHERE NOT f IN forms_with_changes] as forms_without_changes\n\n// Unwind changed data\nUNWIND all_data as data\n\n// Filter to only changed rows and collect\nWITH collect(CASE WHEN data.has_change THEN data ELSE null END) as changed_data, \n     forms_without_changes\n\n// Add rows for unchanged forms\nWITH [d IN changed_data WHERE d IS NOT NULL] + \n     [f IN forms_without_changes | {\n       form_oid: f,\n       level: 'CRF',\n       group_oid: null,\n       oid: null,\n       field: 'status',\n       Base: 'No changes',\n       Compare: 'No changes',\n       has_change: false\n     }] as final_data\n\nUNWIND final_data as row\nWITH row,\n  row.form_oid as `CRF OID`,\n  row.level as Level,\n  CASE WHEN row.level = 'Group' THEN row.oid WHEN row.level = 'Item' THEN row.group_oid ELSE null END as `Group OID`,\n  CASE WHEN row.level = 'Item' THEN row.oid ELSE null END as `Item OID`,\n  row.field as Attribute,\n  CASE \n    WHEN row.has_change = false THEN 'âšª No Changes'\n    WHEN row.Base IS NULL THEN 'âœ… Added'\n    WHEN row.Compare IS NULL THEN 'âŒ Removed'\n    ELSE 'ðŸ”„ Modified'\n  END as `Change Type`,\n  coalesce(row.Base, '_null_') as `Base Value`,\n  coalesce(row.Compare, '_null_') as `Compare Value`\nWITH row,`CRF OID`, Level,`Group OID`,`Item OID`,Attribute, `Change Type`,`Base Value`,`Compare Value` where `Change Type` = $neodash_type_of_change or $neodash_type_of_change=''\nRETURN `CRF OID`, Level,`Group OID`,`Item OID`,Attribute, `Change Type`,`Base Value`,`Compare Value`\nORDER BY row.has_change DESC, `CRF OID`, `Group OID`, row.level DESC, `Item OID`, Attribute",
          "width": 18,
          "height": 14,
          "x": 0,
          "y": 0,
          "type": "table",
          "selection": {},
          "settings": {
            "actionsRules": [
              {
                "condition": "Click",
                "field": "",
                "value": "",
                "customization": "set variable",
                "customizationValue": ""
              }
            ],
            "fullscreenEnabled": true,
            "refreshButtonEnabled": true,
            "fontSize": 12,
            "monospace": false,
            "noDataMessage": "Select collections to compare in 2nd tab (CRF Collection)"
          },
          "schema": []
        },
        {
          "id": "97edf6f5-d59d-4f89-8d8e-7e95c9fe347c",
          "title": "Filter CRF ",
          "query": "MATCH\n  (coll_root:OdmStudyEventRoot)-[coll_version:HAS_VERSION]->\n  (coll:OdmStudyEventValue)\nWHERE elementId(coll) IN [$neodash_coll_base_id, $neodash_coll_comp_id]\nOPTIONAL MATCH (coll)-[:FORM_REF]->(form:OdmFormValue)\nWHERE toLower(toString(form.`oid`)) CONTAINS toLower($input) \nRETURN DISTINCT form.`oid` as value,  form.`name` as display ORDER BY size(toString(value)) ASC LIMIT 100\n",
          "width": 6,
          "height": 2,
          "x": 18,
          "y": 0,
          "type": "select",
          "selection": {},
          "settings": {
            "type": "Custom Query",
            "entityType": "CRF in Collection",
            "parameterName": "neodash_crf_in_collection"
          },
          "schema": []
        },
        {
          "id": "f82affc7-6f5c-4d85-b04f-543b767444f5",
          "title": "Filter Change Type",
          "query": "WITH ['âšª No Changes','âœ… Added','âŒ Removed'] as change_types UNWIND change_types as change_type\nWITH change_type WHERE toLower(change_type) CONTAINS toLower($input) \nRETURN DISTINCT change_type as value,  change_type as display ORDER BY display DESC",
          "width": 6,
          "height": 2,
          "x": 18,
          "y": 2,
          "type": "select",
          "selection": {},
          "settings": {
            "type": "Custom Query",
            "entityType": "Type of Change",
            "parameterName": "neodash_type_of_change"
          },
          "schema": []
        },
        {
          "id": "f2552df0-32f6-4f64-8097-b2b65498825f",
          "title": "Summary ",
          "query": "WITH [\n  {id: $neodash_coll_base_id, version: $neodash_coll_base_version_num, label: 'Base'},\n  {id: $neodash_coll_comp_id, version: $neodash_coll_comp_version_num, label: 'Compare'}\n] AS selections\n\nUNWIND selections AS selection\n\nMATCH (coll_root:OdmStudyEventRoot)-[coll_version:HAS_VERSION]->(coll:OdmStudyEventValue)\nWHERE elementId(coll) = selection.id AND coll_version.version = selection.version\n\nOPTIONAL MATCH (coll)-[:FORM_REF]->(form:OdmFormValue) \nWHERE form.oid = $neodash_crf_in_collection OR $neodash_crf_in_collection=''\nOPTIONAL MATCH (form)-[:HAS_DESCRIPTION]->(form_desc:OdmDescription)\nOPTIONAL MATCH (form)-[:HAS_ALIAS]->(form_alias:OdmAlias)\nOPTIONAL MATCH (form)-[:ITEM_GROUP_REF]->(group:OdmItemGroupValue)\nOPTIONAL MATCH (group)-[:HAS_DESCRIPTION]->(group_desc:OdmDescription)\nOPTIONAL MATCH (group)-[:HAS_ALIAS]->(group_alias:OdmAlias)\nOPTIONAL MATCH (group)-[:ITEM_REF]->(item:OdmItemValue)\nOPTIONAL MATCH (item)-[:HAS_DESCRIPTION]->(item_desc:OdmDescription)\nOPTIONAL MATCH (item)-[:HAS_ALIAS]->(item_alias:OdmAlias)\n\nWITH selection.label as collection,\n     form, form.oid as form_oid,\n     group, group.oid as group_oid,\n     item, item.oid as item_oid,\n     apoc.map.mergeList([\n       coalesce(properties(form), {}),\n       CASE WHEN form_desc IS NOT NULL THEN apoc.map.fromPairs([key IN keys(properties(form_desc)) | [\"desc-\" + key, properties(form_desc)[key]]]) ELSE {} END,\n       CASE WHEN form_alias IS NOT NULL THEN apoc.map.fromPairs([key IN keys(properties(form_alias)) | [\"alias-\" + key, properties(form_alias)[key]]]) ELSE {} END\n     ]) AS form_props,\n     apoc.map.mergeList([\n       coalesce(properties(group), {}),\n       CASE WHEN group_desc IS NOT NULL THEN apoc.map.fromPairs([key IN keys(properties(group_desc)) | [\"desc-\" + key, properties(group_desc)[key]]]) ELSE {} END,\n       CASE WHEN group_alias IS NOT NULL THEN apoc.map.fromPairs([key IN keys(properties(group_alias)) | [\"alias-\" + key, properties(group_alias)[key]]]) ELSE {} END\n     ]) AS group_props,\n     apoc.map.mergeList([\n       coalesce(properties(item), {}),\n       CASE WHEN item_desc IS NOT NULL THEN apoc.map.fromPairs([key IN keys(properties(item_desc)) | [\"desc-\" + key, properties(item_desc)[key]]]) ELSE {} END,\n       CASE WHEN item_alias IS NOT NULL THEN apoc.map.fromPairs([key IN keys(properties(item_alias)) | [\"alias-\" + key, properties(item_alias)[key]]]) ELSE {} END\n     ]) AS item_props\n\nWITH collection, form_oid, group_oid, item_oid,\n     CASE WHEN form IS NOT NULL THEN [{level: 'CRF', oid: form_oid, group_oid: null, form_oid: form_oid, props: form_props}] ELSE [] END +\n     CASE WHEN group IS NOT NULL THEN [{level: 'Group', oid: group_oid, group_oid: group_oid, form_oid: form_oid, props: group_props}] ELSE [] END +\n     CASE WHEN item IS NOT NULL THEN [{level: 'Item', oid: item_oid, group_oid: group_oid, form_oid: form_oid, props: item_props}] ELSE [] END AS all_levels\n\nUNWIND all_levels AS level_data\n\nWITH collection, \n     level_data.level as level, \n     level_data.oid as oid, \n     level_data.form_oid as form_oid,\n     level_data.group_oid as group_oid,\n     level_data.props as props\n\nUNWIND keys(props) AS field\n\nWITH level, oid, form_oid, group_oid, field,\n  apoc.map.fromPairs(collect([collection, props[field]])) AS value_map\n\nWITH level, oid, form_oid, group_oid, field,\n  replace(replace(toString(value_map['Base']), '<p>', ''), '</p>', '') AS Base,\n  replace(replace(toString(value_map['Compare']), '<p>', ''), '</p>', '') AS Compare\n\nWITH collect({\n       level: level, \n       oid: oid, \n       form_oid: form_oid, \n       group_oid: group_oid, \n       field: field, \n       Base: Base, \n       Compare: Compare,\n       has_change: (Base <> Compare OR (Base IS NULL AND Compare IS NOT NULL) OR (Base IS NOT NULL AND Compare IS NULL))\n     }) as all_data\n\nWITH all_data,\n     apoc.coll.toSet([d IN all_data WHERE d.has_change = true | d.form_oid]) as forms_with_changes,\n     apoc.coll.toSet([d IN all_data | d.form_oid]) as all_forms,\n     size([d IN all_data WHERE d.has_change = true AND d.level = 'CRF']) as crf_changes,\n     size([d IN all_data WHERE d.has_change = true AND d.level = 'Group']) as group_changes,\n     size([d IN all_data WHERE d.has_change = true AND d.level = 'Item']) as item_changes,\n     size([d IN all_data WHERE d.has_change = true AND d.Base IS NULL]) as added_count,\n     size([d IN all_data WHERE d.has_change = true AND d.Compare IS NULL]) as removed_count,\n     size([d IN all_data WHERE d.has_change = true AND d.Base IS NOT NULL AND d.Compare IS NOT NULL]) as modified_count\n\nWITH forms_with_changes, all_forms, crf_changes, group_changes, item_changes, added_count, removed_count, modified_count,\n     [f IN all_forms WHERE NOT f IN forms_with_changes] as forms_without_changes\n\nWITH '# ðŸ“‹ CRF Collection Comparison Summary\\n\\n' +\n     '## ð•ðžð«ð¬ð¢ð¨ð§ ðˆð§ðŸð¨ð«ð¦ðšð­ð¢ð¨ð§\\n' +\n     '- ððšð¬ðž ð•ðžð«ð¬ð¢ð¨ð§: ' + toString($neodash_coll_base_version_num) + '\\n' +\n     '- ð‚ð¨ð¦ð©ðšð«ðž ð•ðžð«ð¬ð¢ð¨ð§: ' + toString($neodash_coll_comp_version_num) + '\\n\\n' +\n     '---\\n\\n' +\n     '## ðŽð¯ðžð«ðšð¥ð¥ ð’ð­ðšð­ð¢ð¬ð­ð¢ðœð¬\\n' +\n     '- ð“ð¨ð­ðšð¥ ð‚ð‘ð…ð¬ ð€ð§ðšð¥ð²ð³ðžð: ' + toString(size(all_forms)) + '\\n' +\n     '- ð‚ð‘ð…ð¬ ð°ð¢ð­ð¡ ð‚ð¡ðšð§ð ðžð¬: ' + toString(size(forms_with_changes)) + '\\n' +\n     '- ð‚ð‘ð…ð¬ ð°ð¢ð­ð¡ð¨ð®ð­ ð‚ð¡ðšð§ð ðžð¬: ' + toString(size(forms_without_changes)) + '\\n\\n' +\n     '---\\n\\n' +\n     '## ð‚ð¡ðšð§ð ðžð¬ ð›ð² ð‹ðžð¯ðžð¥\\n' +\n     '- ð‚ð‘ð…-ð¥ðžð¯ðžð¥ ð‚ð¡ðšð§ð ðžð¬: ' + toString(crf_changes) + ' attributes\\n' +\n     '- ð†ð«ð¨ð®ð©-ð¥ðžð¯ðžð¥ ð‚ð¡ðšð§ð ðžð¬: ' + toString(group_changes) + ' attributes\\n' +\n     '- ðˆð­ðžð¦-ð¥ðžð¯ðžð¥ ð‚ð¡ðšð§ð ðžð¬: ' + toString(item_changes) + ' attributes\\n' +\n     '- ð“ð¨ð­ðšð¥ ð‚ð¡ðšð§ð ðžð¬: ' + toString(crf_changes + group_changes + item_changes) + ' attributes\\n\\n' +\n     '---\\n\\n' +\n     '## ð‚ð¡ðšð§ð ðžð¬ ð›ð² ð“ð²ð©ðž\\n' +\n     '- âœ… ð€ðððžð: ' + toString(added_count) + ' attributes\\n' +\n     '- âŒ ð‘ðžð¦ð¨ð¯ðžð: ' + toString(removed_count) + ' attributes\\n' +\n     '- ðŸ”„ ðŒð¨ðð¢ðŸð¢ðžð: ' + toString(modified_count) + ' attributes\\n\\n' +\n     CASE WHEN size(forms_without_changes) > 0 THEN\n       '---\\n\\n' +\n       '## ð‚ð‘ð…ð¬ ð°ð¢ð­ð¡ ðð¨ ð‚ð¡ðšð§ð ðžð¬\\n' +\n       apoc.text.join([f IN forms_without_changes | '- ' + f], '\\n') + '\\n'\n     ELSE '' END AS summary\n\nRETURN summary",
          "width": 6,
          "height": 10,
          "x": 18,
          "y": 4,
          "type": "value",
          "selection": {},
          "settings": {
            "fontSize": 14,
            "monospace": true
          },
          "schema": []
        }
      ]
    },
    {
      "title": "CRF Versions",
      "reports": [
        {
          "id": "d900d420-e89f-457b-b6dd-21dea0ac67bf",
          "title": "CRF - Select Base",
          "query": "match(form:OdmFormValue)<-[form_version:HAS_VERSION]-(form_root:OdmFormRoot)\nWHERE $neodash_odmformvalue_oid IS NULL \n   OR $neodash_odmformvalue_oid = '' \n   OR form.oid = $neodash_odmformvalue_oid\nreturn form.oid as OID, \nform.name as `Name`, \nform_version.version as Version, \n'Base' as Select, \nelementId(form) as __crf_id,\nform_version.version as __crf_version\norder by OID, Version\n\n\n\n\n\n",
          "width": 8,
          "height": 5,
          "x": 0,
          "y": 0,
          "type": "table",
          "selection": {},
          "settings": {
            "actionsRules": [
              {
                "condition": "Click",
                "field": "Select",
                "value": "__crf_id",
                "customization": "set variable",
                "customizationValue": "crf_base_id"
              },
              {
                "condition": "Click",
                "field": "Select",
                "value": "__crf_version",
                "customization": "set variable",
                "customizationValue": "crf_base_version_num"
              }
            ],
            "compact": true,
            "wrapContent": true,
            "columnWidths": "[1,2,0.5,1]",
            "refreshButtonEnabled": true
          }
        },
        {
          "id": "4dce695c-4b1a-41e1-860c-028463d2bcd9",
          "title": "CRF - Select Compare",
          "query": "match(form:OdmFormValue)<-[form_version:HAS_VERSION]-(form_root:OdmFormRoot)\nWHERE $neodash_odmformvalue_oid IS NULL \n   OR $neodash_odmformvalue_oid = '' \n   OR form.oid = $neodash_odmformvalue_oid\nreturn form.oid as OID, \nform.name as `Name`, \nform_version.version as Version, \n'Compare' as Select, \nelementId(form) as __crf_id,\nform_version.version as __crf_version\norder by OID, Version\n\n\n\n\n\n",
          "width": 8,
          "height": 5,
          "x": 8,
          "y": 0,
          "type": "table",
          "selection": {},
          "settings": {
            "actionsRules": [
              {
                "condition": "Click",
                "field": "Select",
                "value": "__crf_id",
                "customization": "set variable",
                "customizationValue": "crf_comp_id"
              },
              {
                "condition": "Click",
                "field": "Select",
                "value": "__crf_version",
                "customization": "set variable",
                "customizationValue": "crf_comp_version_num"
              }
            ],
            "compact": true,
            "wrapContent": true,
            "columnWidths": "[1,2,0.5,1.1]",
            "refreshButtonEnabled": true
          }
        },
        {
          "id": "c5614468-1139-42d5-a080-0ee57115cb79",
          "title": "CRF Attributes differences",
          "query": "MATCH (form:OdmFormValue)<-[:HAS_VERSION]-(form_root:OdmFormRoot) \nWHERE elementId(form) IN [$neodash_crf_base_id, $neodash_crf_comp_id]\nWITH CASE WHEN count(DISTINCT form_root) > 1 THEN 'Across CRF' ELSE 'Within CRF' END AS compare_type\n\nWITH compare_type, [\n  {id: $neodash_crf_base_id, version: $neodash_crf_base_version_num, label: 'Base'},\n  {id: $neodash_crf_comp_id, version: $neodash_crf_comp_version_num, label: 'Compare'}\n] AS selections\n\nUNWIND selections AS selection\n\nMATCH (form:OdmFormValue)<-[form_version:HAS_VERSION]-(form_root:OdmFormRoot) \nWHERE elementId(form) = selection.id \n  AND form_version.version = selection.version\nOPTIONAL MATCH (form)-[r1_2:HAS_DESCRIPTION]->(form_desc:OdmDescription)\nOPTIONAL MATCH (form)-[r1_3:HAS_ALIAS]->(form_alias:OdmAlias)\nOPTIONAL MATCH (form)-[r1_4:HAS_VENDOR_ELEMENT]->(f_ext_elem:OdmVendorElementValue)<-[r1_5:HAS_VENDOR_ELEMENT]-(f_elem_vendor_ns:OdmVendorNamespaceValue)<-[f_elem_vendor_ns_version:HAS_VERSION]-(),(f_ext_elem)<-[f_ext_elem_version:HAS_VERSION]-()\nOPTIONAL MATCH (form)-[r1_6:HAS_VENDOR_ATTRIBUTE]->(f_ext_att:OdmVendorAttributeValue)<-[r1_7:HAS_VENDOR_ATTRIBUTE]-(f_att_vendor_ns:OdmVendorNamespaceValue)<-[f_att_vendor_ns_version:HAS_VERSION]-(),(f_ext_att)<-[f_ext_att_version:HAS_VERSION]-()\nWITH DISTINCT\n  selection,\n  form,\n  form_version,\n  CASE\n    WHEN\n      form_alias IS NOT NULL\n      THEN\n        apoc.map.fromPairs(\n          [\n            key IN keys(properties(form_alias))\n            | [\"alias-\" + key, properties(form_alias)[key]]\n          ])\n    ELSE {}\n  END AS aliasMap,\n  CASE\n    WHEN\n      form_desc IS NOT NULL\n      THEN\n        apoc.map.fromPairs(\n          [\n            key IN keys(properties(form_desc))\n            | [\"desc-\" + key, properties(form_desc)[key]]\n          ])\n    ELSE {}\n  END AS descMap,\n  CASE\n  WHEN f_ext_elem IS NOT NULL AND f_ext_elem_version IS NOT NULL\n    THEN apoc.map.fromPairs([key IN keys(properties(f_ext_elem)) | [\"elemExt-\" + key, properties(f_ext_elem)[key]+'(V'+f_ext_elem_version.version+')']])\n  ELSE {}\nEND AS f_ext_elemMap,\nCASE\n  WHEN f_ext_att IS NOT NULL AND f_ext_att_version IS NOT NULL\n    THEN apoc.map.fromPairs([key IN keys(properties(f_ext_att)) | [\"attExt-\" + key, properties(f_ext_att)[key]+'(V'+f_ext_att_version.version+')']])\n  ELSE {}\nEND AS f_ext_attMap,\nCASE\n  WHEN f_elem_vendor_ns IS NOT NULL AND f_elem_vendor_ns_version IS NOT NULL\n    THEN apoc.map.fromPairs([key IN keys(properties(f_elem_vendor_ns)) | [\"elem_nsExt-\" + key, properties(f_elem_vendor_ns)[key]+'(V'+f_elem_vendor_ns_version.version+')']])\n  ELSE {}\nEND AS f_elem_vendor_nsMap,\nCASE\n  WHEN f_att_vendor_ns IS NOT NULL AND f_att_vendor_ns_version IS NOT NULL\n    THEN apoc.map.fromPairs([key IN keys(properties(f_att_vendor_ns)) | [\"att_nsExt-\" + key, properties(f_att_vendor_ns)[key]+'(V'+f_att_vendor_ns_version.version+')']])\n  ELSE {}\nEND AS f_att_vendor_nsMap,\n  coalesce(properties(form), {}) AS formMap\nWITH\n  selection,\n  form,\n  form_version,\napoc.map.mergeList([formMap, descMap, aliasMap, f_att_vendor_nsMap, f_elem_vendor_nsMap, f_ext_attMap, f_ext_elemMap]) AS props_map\nUNWIND keys(props_map) AS field\nWITH\n  form.oid AS OID,\n  field,\n  apoc.map.fromPairs(collect([selection.label, props_map[field]])) AS value_map\nWITH\n  OID AS `CRF OID`,\n  CASE split(field, '-')[0]\n  WHEN 'elem_nsExt' THEN '7ElementVendorExtNameSpace'\n  WHEN 'elemExt' THEN '6ElementVendorExt'\n  WHEN 'att_nsExt' THEN '5AttributeVendorExtNameSpace'\n  WHEN 'attExt' THEN '4AttributeVendorExt'\n  WHEN 'desc' THEN '2Description'\n  WHEN 'alias' THEN '3Alias'\n  ELSE '1Identification'\nEND AS area,\n  CASE WHEN split(field, '-')[0] IN ['desc', 'alias', 'attExt','elemExt','elem_nsExt','att_nsExt'] \n     THEN split(field, '-')[1]  \n     ELSE field \nEND AS `CRF attribute`,  \n  replace(replace(toString(value_map['Base']), '<p>', ''), '</p>', '')   AS Base,\n  replace(replace(toString(value_map['Compare']), '<p>', ''), '</p>', '')  AS Compare\nORDER BY `CRF OID`, area, `CRF attribute`\nWITH `CRF OID`,area, `CRF attribute`, Base, Compare, \nCASE WHEN Base = Compare THEN 'N' ELSE CASE WHEN Base is null and Compare is null THEN 'N' ELSE 'Y' END END as __diff,\nCASE \n    WHEN Base = Compare THEN 'âšª No Changes'\n    WHEN Base IS NULL THEN 'âœ… Added'\n    WHEN Compare IS NULL THEN 'âŒ Removed'\n    ELSE 'ðŸ”„ Modified'\nEND AS `Change Type`\nRETURN `CRF OID`, substring(area,1) as Area, `CRF attribute`, Base, Compare, `Change Type`, __diff",
          "width": 16,
          "height": 4,
          "x": 8,
          "y": 5,
          "type": "table",
          "selection": {},
          "settings": {
            "compact": true,
            "wrapContent": true,
            "columnWidths": "[1,1,1,2,2]",
            "styleRules": [
              {
                "field": "__diff",
                "condition": "=",
                "value": "Y",
                "customization": "row color",
                "customizationValue": "#FF11116E"
              },
              {
                "field": "__diff",
                "condition": "=",
                "value": "N",
                "customization": "row color",
                "customizationValue": "#5FE8866E"
              }
            ],
            "fullscreenEnabled": true,
            "allowDownload": true
          }
        },
        {
          "id": "5a5e2571-f1e6-4dd6-9f7b-b75c0990a4ad",
          "title": "Selected CRF versions",
          "query": "MATCH (form:OdmFormValue)<-[:HAS_VERSION]-(form_root:OdmFormRoot) \nWHERE elementId(form) IN [$neodash_crf_base_id, $neodash_crf_comp_id]\nWITH CASE WHEN count(DISTINCT form_root) > 1 THEN 'Across CRF' ELSE 'Within CRF' END AS compare_type\n\nWITH compare_type, [\n  {id: $neodash_crf_base_id, version: $neodash_crf_base_version_num, label: 'Base'},\n  {id: $neodash_crf_comp_id, version: $neodash_crf_comp_version_num, label: 'Compare'}\n] AS selections\n\nUNWIND selections AS selection\n\nMATCH (form:OdmFormValue)<-[form_version:HAS_VERSION]-(form_root:OdmFormRoot) \nWHERE elementId(form) = selection.id \n  AND form_version.version = selection.version\n\nRETURN \n  selection.label as `CRF Selection`,\n  form.oid as OID, \n  form.name as Name, \n  form_version.version as Version, \n  compare_type as `Compare Type`\nORDER BY OID, Version, `CRF Selection`",
          "width": 8,
          "height": 3,
          "x": 16,
          "y": 2,
          "type": "table",
          "selection": {},
          "settings": {
            "refreshButtonEnabled": true,
            "transposed": true,
            "compact": true
          }
        },
        {
          "id": "6df2a57c-f04d-4182-b777-08322a42d7b6",
          "title": "Filter CRF",
          "query": "MATCH (n:`OdmFormValue`) \nWHERE toLower(toString(n.`oid`)) CONTAINS toLower($input) \nRETURN DISTINCT n.`oid` as value,  n.`name` as display ORDER BY size(toString(value)) ASC LIMIT 1000",
          "width": 8,
          "height": 2,
          "x": 16,
          "y": 0,
          "type": "select",
          "selection": {},
          "settings": {
            "type": "Custom Query",
            "refreshButtonEnabled": true,
            "multiline": false,
            "overridePropertyDisplayName": false,
            "suggestionLimit": 1000,
            "manualPropertyNameSpecification": true,
            "helperText": "Filter CRF (optional)",
            "entityType": "odmformvalue_oid",
            "parameterName": "neodash_odmformvalue_oid"
          },
          "schema": []
        },
        {
          "id": "b641654f-0d3f-47dc-9cfc-f38a201ecd59",
          "title": "In collection(s)",
          "query": "MATCH (form:OdmFormValue)<-[:HAS_VERSION]-(form_root:OdmFormRoot) \nWHERE elementId(form) IN [$neodash_crf_base_id, $neodash_crf_comp_id]\nWITH CASE WHEN count(DISTINCT form_root) > 1 THEN 'Across CRF' ELSE 'Within CRF' END AS compare_type\n\nWITH compare_type, [\n  {id: $neodash_crf_base_id, version: $neodash_crf_base_version_num, label: 'Base'},\n  {id: $neodash_crf_comp_id, version: $neodash_crf_comp_version_num, label: 'Compare'}\n] AS selections\n\nUNWIND selections AS selection\n\nMATCH (form:OdmFormValue)<-[form_version:HAS_VERSION]-(form_root:OdmFormRoot) \nWHERE elementId(form) = selection.id \n  AND form_version.version = selection.version\n  OPTIONAL MATCH (coll_root:OdmStudyEventRoot)-[coll_version:HAS_VERSION]->(coll:OdmStudyEventValue)-[r1_1:FORM_REF]->(form:OdmFormValue)\n WITH distinct selection, collect(DISTINCT coll.name+'(V'+coll_version.version+')') AS coll\n WITH apoc.map.fromPairs(collect([selection.label, coll])) AS data\nWITH data, \n     CASE WHEN size(data.Base) > size(data.Compare) \n          THEN size(data.Base) \n          ELSE size(data.Compare) \n     END AS maxSize\nUNWIND range(0, maxSize - 1) AS idx\nRETURN CASE WHEN idx < size(data.Base) THEN data.Base[idx] END AS Base,\n       CASE WHEN idx < size(data.Compare) THEN data.Compare[idx] END AS Compare",
          "width": 8,
          "height": 4,
          "x": 0,
          "y": 5,
          "type": "table",
          "selection": {},
          "settings": {
            "refreshButtonEnabled": true,
            "compact": true,
            "wrapContent": true,
            "transposed": false
          }
        },
        {
          "id": "144130f5-6e7d-49e9-a427-cc5c09c51e82",
          "title": "Group Count",
          "query": "MATCH (form:OdmFormValue)<-[:HAS_VERSION]-(form_root:OdmFormRoot) \nWHERE elementId(form) IN [$neodash_crf_base_id, $neodash_crf_comp_id]\nWITH CASE WHEN count(DISTINCT form_root) > 1 THEN 'Across CRF' ELSE 'Within CRF' END AS compare_type\n\nWITH compare_type, [\n  {id: $neodash_crf_base_id, version: $neodash_crf_base_version_num, label: 'Base'},\n  {id: $neodash_crf_comp_id, version: $neodash_crf_comp_version_num, label: 'Compare'}\n] AS selections\n\nUNWIND selections AS selection\nMATCH (form:OdmFormValue)<-[form_version:HAS_VERSION]-(form_root:OdmFormRoot) \nWHERE elementId(form) = selection.id \n  AND form_version.version = selection.version\nWITH selection,form, form_version where form_version.version in[$neodash_crf_base_version_num, $neodash_crf_comp_version_num]\nOPTIONAL MATCH (form)-[:ITEM_GROUP_REF]->(group:OdmItemGroupValue)\nRETURN  \n      selection.label+'-V'+toString(form_version.version) AS version,\n        toInteger(COUNT(DISTINCT group)) AS `Group count`,\n        'GROUP_COUNT' AS metric_type",
          "width": 8,
          "height": 5,
          "x": 0,
          "y": 9,
          "type": "bar",
          "selection": {
            "index": "version",
            "value": "Group count",
            "key": "(none)"
          },
          "settings": {
            "showOptionalSelections": false,
            "refreshButtonEnabled": true,
            "legend": false,
            "hideSelections": true,
            "innerPadding": 10,
            "displayYGridLines": false,
            "labelRotation": 0,
            "barValues": true,
            "displayYAxis": false,
            "colors": "nivo"
          },
          "schema": []
        },
        {
          "id": "f0a17a40-999e-4a9b-a3a2-bbc4bb733e66",
          "title": "Group Attributes differences",
          "query": "MATCH (form:OdmFormValue)<-[:HAS_VERSION]-(form_root:OdmFormRoot) \nWHERE elementId(form) IN [$neodash_crf_base_id, $neodash_crf_comp_id]\nWITH CASE WHEN count(DISTINCT form_root) > 1 THEN 'Across CRF' ELSE 'Within CRF' END AS compare_type\nWITH compare_type, [\n  {id: $neodash_crf_base_id, version: $neodash_crf_base_version_num, label: 'Base'},\n  {id: $neodash_crf_comp_id, version: $neodash_crf_comp_version_num, label: 'Compare'}\n] AS selections\nUNWIND selections AS selection\nMATCH (form:OdmFormValue)<-[form_version:HAS_VERSION]-(form_root:OdmFormRoot) \nWHERE elementId(form) = selection.id \n  AND form_version.version = selection.version\n  //Get the groups in the form and the group details\noptional match(form)-[r1_4:ITEM_GROUP_REF]->(group:OdmItemGroupValue)<-[group_version:HAS_VERSION]-(group_root:OdmItemGroupRoot)\noptional match(group)-[r2_1:HAS_DESCRIPTION]->(group_desc:OdmDescription)\noptional match(group)-[r2_2:HAS_ALIAS]->(group_alias:OdmAlias)\noptional match(group)-[r2_3:HAS_SDTM_DOMAIN]->(g_context:CTTermContext)-[r2_4:HAS_SELECTED_TERM]->(g_term_root:CTTermRoot)<-[r2_5:HAS_TERM_ROOT]-(domain:CTCodelistTerm)\nWITH DISTINCT\n  selection.label AS form_compare,\n  form,\n  group,\n  CASE\n    WHEN\n      group_alias IS NOT NULL\n      THEN\n        apoc.map.fromPairs(\n          [\n            key IN keys(properties(group_alias))\n            | [\"alias-\" + key, properties(group_alias)[key]]\n          ])\n    ELSE null\n  END AS aliasMap,\n  CASE\n    WHEN\n      group_desc IS NOT NULL\n      THEN\n        apoc.map.fromPairs(\n          [\n            key IN keys(properties(group_desc))\n            | [\"desc-\" + key, properties(group_desc)[key]]\n          ])\n    ELSE null\n  END AS descMap,\n  // Domain map\n    CASE\n    WHEN\n      domain IS NOT NULL\n      THEN\n        apoc.map.fromPairs(\n          [\n            key IN keys(properties(domain))\n            | [\"domain-\" + key, properties(domain)[key]]\n          ])\n    ELSE null\n  END AS domainMap,\n  properties(group) AS groupMap\nWITH\n  form_compare,\n  form,\n  group,\n  apoc.map.merge(groupMap, apoc.map.merge(descMap, apoc.map.merge(aliasMap,domainMap))) AS props_map\nWITH form_compare, form, group, props_map\nUNWIND keys(props_map) AS field\nWITH DISTINCT\n  form.oid AS fOID,\n  group.oid as gOID,\n  field,\n  apoc.map.fromPairs(collect([form_compare, props_map[field]])) AS value_map\nWITH DISTINCT\n  fOID AS `CRF OID`,\n  gOID as `Group OID`,\n  CASE WHEN field contains 'desc-' THEN '2Description' ELSE \n  CASE WHEN field contains 'alias-' THEN '3Alias' ELSE \n  CASE WHEN field contains 'domain-' THEN '4Domain' ELSE '1Identification' END END END as area,\n  CASE WHEN (field contains 'desc-') OR (field contains 'alias-') OR (field contains 'domain-') THEN split(field, '-')[1]  ELSE field END AS `Group attribute`,\n  replace(replace(toString(value_map['Base']), '<p>', ''), '</p>', '')   AS Base,\n  replace(replace(toString(value_map['Compare']), '<p>', ''), '</p>', '')  AS Compare\nORDER BY `CRF OID`, `Group OID`, area, `Group attribute`\nWITH DISTINCT `CRF OID`, `Group OID`, area, `Group attribute`, Base, Compare, \nCASE WHEN Base = Compare THEN 'N' ELSE CASE WHEN Base is null and Compare is null THEN 'N' ELSE 'Y' END END as __diff,\nCASE \n    WHEN Base = Compare THEN 'âšª No Changes'\n    WHEN Base IS NULL THEN 'âœ… Added'\n    WHEN Compare IS NULL THEN 'âŒ Removed'\n    ELSE 'ðŸ”„ Modified'\nEND AS `Change Type`\nRETURN `Group OID`, substring(area,1) as Area, `Group attribute`, Base, Compare, `Change Type`, __diff",
          "width": 16,
          "height": 5,
          "x": 8,
          "y": 9,
          "type": "table",
          "selection": {},
          "settings": {
            "refreshButtonEnabled": true,
            "compact": true,
            "wrapContent": true,
            "styleRules": [
              {
                "field": "__diff",
                "condition": "=",
                "value": "Y",
                "customization": "row color",
                "customizationValue": "#FF11116E"
              },
              {
                "field": "__diff",
                "condition": "=",
                "value": "N",
                "customization": "row color",
                "customizationValue": "#5FE8866E "
              }
            ],
            "fullscreenEnabled": true,
            "allowDownload": true
          }
        },
        {
          "id": "5e9eddc6-9579-4143-aa08-da7522dd86d7",
          "title": "Item Count",
          "query": "MATCH (form:OdmFormValue)<-[:HAS_VERSION]-(form_root:OdmFormRoot) \nWHERE elementId(form) IN [$neodash_crf_base_id, $neodash_crf_comp_id]\nWITH CASE WHEN count(DISTINCT form_root) > 1 THEN 'Across CRF' ELSE 'Within CRF' END AS compare_type\n\nWITH compare_type, [\n  {id: $neodash_crf_base_id, version: $neodash_crf_base_version_num, label: 'Base'},\n  {id: $neodash_crf_comp_id, version: $neodash_crf_comp_version_num, label: 'Compare'}\n] AS selections\n\nUNWIND selections AS selection\nMATCH (form:OdmFormValue)<-[form_version:HAS_VERSION]-(form_root:OdmFormRoot) \nWHERE elementId(form) = selection.id \n  AND form_version.version = selection.version\nOPTIONAL MATCH (form)-[:ITEM_GROUP_REF]->(group:OdmItemGroupValue) where group.oid=$neodash_select_group_2\nOPTIONAL MATCH (group)-[:ITEM_REF]->(item:OdmItemValue)\nRETURN  \n      selection.label+'-V'+toString(form_version.version) AS version,\n        toInteger(COUNT(DISTINCT item)) AS `Item count`,\n        'ITEM_COUNT' AS metric_type\nORDER BY version",
          "width": 8,
          "height": 5,
          "x": 0,
          "y": 16,
          "type": "bar",
          "selection": {
            "index": "version",
            "value": "Item count",
            "key": "(none)"
          },
          "settings": {
            "showOptionalSelections": false,
            "refreshButtonEnabled": true,
            "legend": false,
            "hideSelections": true,
            "innerPadding": 10,
            "displayYGridLines": false,
            "labelRotation": 0,
            "barValues": true,
            "displayYAxis": false,
            "colors": "category10"
          },
          "schema": []
        },
        {
          "id": "15aadad1-60fe-4c24-81c1-e7ba4aa92cbd",
          "title": "Select Group",
          "query": "MATCH (form:OdmFormValue)<-[form_version:HAS_VERSION]-\n  (form_root:OdmFormRoot) where elementId(form) IN [$neodash_crf_base_id, $neodash_crf_comp_id]\nOPTIONAL MATCH (form)-[:ITEM_GROUP_REF]->(group:OdmItemGroupValue)\nWHERE toLower(toString(group.`oid`)) CONTAINS toLower($input) \nRETURN DISTINCT group.`oid` as value,  group.`oid` as display ORDER BY size(toString(value)) ASC LIMIT 100\n",
          "width": 8,
          "height": 2,
          "x": 0,
          "y": 14,
          "type": "select",
          "selection": {},
          "settings": {
            "type": "Custom Query",
            "entityType": "Select Group 2",
            "refreshButtonEnabled": true,
            "overridePropertyDisplayName": false,
            "helperText": "Select Group",
            "parameterName": "neodash_select_group_2"
          },
          "schema": []
        },
        {
          "id": "d028ea6c-7fdb-4aca-9957-6e518a9e9722",
          "title": "Item Attributes differences - $neodash_select_group_2",
          "query": "MATCH (form:OdmFormValue)<-[:HAS_VERSION]-(form_root:OdmFormRoot) \nWHERE elementId(form) IN [$neodash_crf_base_id, $neodash_crf_comp_id]\nWITH CASE WHEN count(DISTINCT form_root) > 1 THEN 'Across CRF' ELSE 'Within CRF' END AS compare_type\nWITH compare_type, [\n  {id: $neodash_crf_base_id, version: $neodash_crf_base_version_num, label: 'Base'},\n  {id: $neodash_crf_comp_id, version: $neodash_crf_comp_version_num, label: 'Compare'}\n] AS selections\nUNWIND selections AS selection\nMATCH (form:OdmFormValue)<-[form_version:HAS_VERSION]-(form_root:OdmFormRoot) \nWHERE elementId(form) = selection.id \n  AND form_version.version = selection.version\n  //Get the groups in the form\noptional match(form)-[r1_4:ITEM_GROUP_REF]->(group:OdmItemGroupValue)\n  //Get the item in the group on the form and the item details\noptional match(group)-[r3_1:ITEM_REF]->(item:OdmItemValue)<-[item_version:HAS_VERSION]-(item_root:OdmItemRoot)\noptional match(item)-[r3_2:HAS_DESCRIPTION]->(item_desc:OdmDescription)\noptional match(item)-[r3_3:HAS_ALIAS]->(item_alias:OdmAlias)\noptional match(item)-[r3_4:HAS_CODELIST_TERM]->(i_context:CTTermContext)-[r3_5:HAS_SELECTED_TERM]->(i_term_root:CTTermRoot)<-[r3_6:HAS_TERM_ROOT]-(item_term:CTCodelistTerm)\nWITH DISTINCT\n  selection.label as form_compare,\n  form_version,\n  form,\n  group,\n  item,\n  CASE\n    WHEN\n      item_alias IS NOT NULL\n      THEN\n        apoc.map.fromPairs(\n          [\n            key IN keys(properties(item_alias))\n            | [\"alias-\" + key, properties(item_alias)[key]]\n          ])\n    ELSE null\n  END AS aliasMap,\n  CASE\n    WHEN\n      item_desc IS NOT NULL\n      THEN\n        apoc.map.fromPairs(\n          [\n            key IN keys(properties(item_desc))\n            | [\"desc-\" + key, properties(item_desc)[key]]\n          ])\n    ELSE null\n  END AS descMap,\n  // Domain map\n    CASE\n    WHEN\n      item_term IS NOT NULL\n      THEN\n        apoc.map.fromPairs(\n          [\n            key IN keys(properties(item_term))\n            | [\"itemterm-\" + key, properties(item_term)[key]]\n          ])\n    ELSE null\n  END AS itemTermMap,\n  properties(item) AS itemMap\nWITH \n  form_compare,\n  form_version,\n  form,\n  group,\n  item,\n  itemMap,\n  descMap,\n  aliasMap,\n  collect(itemTermMap) as itemTermMaps\nWITH \n  form_compare,\n  form_version,\n  form,\n  group,\n  item,\n  itemMap,\n  descMap,\n  aliasMap,\n  CASE WHEN size(itemTermMaps)>0 THEN {`itemterm-submission_value`: apoc.text.join([map IN itemTermMaps WHERE size(keys(map))>0 | map.`itemterm-submission_value`], \";\")} ELSE {} END AS itemTermMap\nWITH form_compare,\n  form_version,\n  form,\n  group,\n  item,\n  apoc.map.merge(itemMap, apoc.map.merge(descMap, apoc.map.merge(aliasMap,itemTermMap))) AS props_map\nWITH form_compare, form, group, item, props_map\nUNWIND keys(props_map) AS field\nWITH DISTINCT\n  form.oid AS fOID,\n  group.oid as gOID,\n  item.oid as iOID,\n  field,\n  apoc.map.fromPairs(collect([form_compare, props_map[field]])) AS value_map\nWITH DISTINCT\n  fOID AS `CRF OID`,\n  gOID as `Group OID`,\n  iOID as `Item OID`,\n  CASE WHEN field contains 'desc-' THEN '2Description' ELSE \n  CASE WHEN field contains 'alias-' THEN '3Alias' ELSE \n  CASE WHEN field contains 'itemterm-' THEN '4Terms' ELSE '1Identification' END END END as area,\n  CASE WHEN (field contains 'desc-') OR (field contains 'alias-') OR (field contains 'domain-') OR (field contains 'itemterm-') THEN split(field, '-')[1]  ELSE field END AS `Item attribute`,\n  replace(replace(toString(value_map['Base']), '<p>', ''), '</p>', '')   AS Base,\n  replace(replace(toString(value_map['Compare']), '<p>', ''), '</p>', '')  AS Compare\nORDER BY `CRF OID`, `Group OID`, `Item OID`, area, `Item attribute`\nWITH DISTINCT `CRF OID`, `Group OID`, `Item OID`, area, `Item attribute`, Base, Compare, \nCASE WHEN Base = Compare THEN 'N' ELSE CASE WHEN Base is null and Compare is null THEN 'N' ELSE 'Y' END END as __diff,\nCASE \n    WHEN Base = Compare THEN 'âšª No Changes'\n    WHEN Base IS NULL THEN 'âœ… Added'\n    WHEN Compare IS NULL THEN 'âŒ Removed'\n    ELSE 'ðŸ”„ Modified'\nEND AS `Change Type`\nRETURN `Item OID`, substring(area,1) as Area, `Item attribute`, Base, Compare, `Change Type`, __diff",
          "width": 16,
          "height": 7,
          "x": 8,
          "y": 14,
          "type": "table",
          "selection": {},
          "settings": {
            "refreshButtonEnabled": true,
            "compact": true,
            "wrapContent": true,
            "styleRules": [
              {
                "field": "__diff",
                "condition": "=",
                "value": "Y",
                "customization": "row color",
                "customizationValue": "#FF11116E"
              },
              {
                "field": "__diff",
                "condition": "=",
                "value": "N",
                "customization": "row color",
                "customizationValue": "#5FE8866E"
              }
            ],
            "fullscreenEnabled": true,
            "allowDownload": true
          }
        }
      ]
    },
    {
      "title": "CRF Release Notes",
      "reports": [
        {
          "id": "520b8644-8b5d-4c53-919b-d0e8f3cc625b",
          "title": "Release Notes( v $neodash_crf_base_version_num â†’ v $neodash_crf_comp_version_num)",
          "query": "WITH [\n  {id: $neodash_crf_base_id, version: $neodash_crf_base_version_num, label: 'Base'},\n  {id: $neodash_crf_comp_id, version: $neodash_crf_comp_version_num, label: 'Compare'}\n] AS selections\n\nUNWIND selections AS selection\n\nMATCH (form_root:OdmFormRoot)-[form_version:HAS_VERSION]->(form:OdmFormValue)\nWHERE elementId(form) = selection.id AND form_version.version = selection.version\n\nOPTIONAL MATCH (form)-[:HAS_DESCRIPTION]->(form_desc:OdmDescription)\nOPTIONAL MATCH (form)-[:HAS_ALIAS]->(form_alias:OdmAlias)\nOPTIONAL MATCH (form)-[:ITEM_GROUP_REF]->(group:OdmItemGroupValue)\n//WHERE group.oid = $neodash_group_in_form OR $neodash_group_in_form=''\nOPTIONAL MATCH (group)-[:HAS_DESCRIPTION]->(group_desc:OdmDescription)\nOPTIONAL MATCH (group)-[:HAS_ALIAS]->(group_alias:OdmAlias)\nOPTIONAL MATCH (group)-[:ITEM_REF]->(item:OdmItemValue)\nOPTIONAL MATCH (item)-[:HAS_DESCRIPTION]->(item_desc:OdmDescription)\nOPTIONAL MATCH (item)-[:HAS_ALIAS]->(item_alias:OdmAlias)\n\nWITH selection.label as version_label,\n     form, form.oid as form_oid,\n     group, group.oid as group_oid,\n     item, item.oid as item_oid,\n     apoc.map.mergeList([\n       coalesce(properties(form), {}),\n       CASE WHEN form_desc IS NOT NULL THEN apoc.map.fromPairs([key IN keys(properties(form_desc)) | [\"desc-\" + key, properties(form_desc)[key]]]) ELSE {} END,\n       CASE WHEN form_alias IS NOT NULL THEN apoc.map.fromPairs([key IN keys(properties(form_alias)) | [\"alias-\" + key, properties(form_alias)[key]]]) ELSE {} END\n     ]) AS form_props,\n     apoc.map.mergeList([\n       coalesce(properties(group), {}),\n       CASE WHEN group_desc IS NOT NULL THEN apoc.map.fromPairs([key IN keys(properties(group_desc)) | [\"desc-\" + key, properties(group_desc)[key]]]) ELSE {} END,\n       CASE WHEN group_alias IS NOT NULL THEN apoc.map.fromPairs([key IN keys(properties(group_alias)) | [\"alias-\" + key, properties(group_alias)[key]]]) ELSE {} END\n     ]) AS group_props,\n     apoc.map.mergeList([\n       coalesce(properties(item), {}),\n       CASE WHEN item_desc IS NOT NULL THEN apoc.map.fromPairs([key IN keys(properties(item_desc)) | [\"desc-\" + key, properties(item_desc)[key]]]) ELSE {} END,\n       CASE WHEN item_alias IS NOT NULL THEN apoc.map.fromPairs([key IN keys(properties(item_alias)) | [\"alias-\" + key, properties(item_alias)[key]]]) ELSE {} END\n     ]) AS item_props\n\nWITH version_label, form_oid, group_oid, item_oid,\n     CASE WHEN form IS NOT NULL THEN [{level: 'CRF', oid: form_oid, group_oid: null, form_oid: form_oid, props: form_props}] ELSE [] END +\n     CASE WHEN group IS NOT NULL THEN [{level: 'Group', oid: group_oid, group_oid: group_oid, form_oid: form_oid, props: group_props}] ELSE [] END +\n     CASE WHEN item IS NOT NULL THEN [{level: 'Item', oid: item_oid, group_oid: group_oid, form_oid: form_oid, props: item_props}] ELSE [] END AS all_levels\n\nUNWIND all_levels AS level_data\n\nWITH version_label, \n     level_data.level as level, \n     level_data.oid as oid, \n     level_data.form_oid as form_oid,\n     level_data.group_oid as group_oid,\n     level_data.props as props\n\nUNWIND keys(props) AS field\n\nWITH level, oid, form_oid, group_oid, field,\n  apoc.map.fromPairs(collect([version_label, props[field]])) AS value_map\n\nWITH level, oid, form_oid, group_oid, field,\n  replace(replace(toString(value_map['Base']), '<p>', ''), '</p>', '') AS Base,\n  replace(replace(toString(value_map['Compare']), '<p>', ''), '</p>', '') AS Compare\n\n// Collect all groups and identify which have changes\nWITH collect({\n       level: level, \n       oid: oid, \n       form_oid: form_oid, \n       group_oid: group_oid, \n       field: field, \n       Base: Base, \n       Compare: Compare,\n       has_change: (Base <> Compare OR (Base IS NULL AND Compare IS NOT NULL) OR (Base IS NOT NULL AND Compare IS NULL))\n     }) as all_data\n\n// Get list of groups with at least one change\nWITH all_data,\n     apoc.coll.toSet([d IN all_data WHERE d.has_change = true AND d.level IN ['Group', 'Item'] | d.group_oid]) as groups_with_changes,\n     apoc.coll.toSet([d IN all_data WHERE d.level IN ['Group', 'Item'] | d.group_oid]) as all_groups\n\n// Find groups with no changes\nWITH all_data, groups_with_changes,\n     [g IN all_groups WHERE NOT g IN groups_with_changes] as groups_without_changes\n\n// Unwind changed data\nUNWIND all_data as data\n\n// Filter to only changed rows and collect\nWITH collect(CASE WHEN data.has_change THEN data ELSE null END) as changed_data, \n     groups_without_changes\n\n// Add rows for unchanged groups\nWITH [d IN changed_data WHERE d IS NOT NULL] + \n     [g IN groups_without_changes | {\n       form_oid: null,\n       level: 'Group',\n       group_oid: g,\n       oid: null,\n       field: 'status',\n       Base: 'No changes',\n       Compare: 'No changes',\n       has_change: false\n     }] as final_data\n\nUNWIND final_data as row\nWITH row,\n  row.form_oid as `CRF OID`,\n  row.level as Level,\n  CASE WHEN row.level = 'Group' THEN row.oid WHEN row.level = 'Item' THEN row.group_oid ELSE null END as `Group OID`,\n  CASE WHEN row.level = 'Item' THEN row.oid ELSE null END as `Item OID`,\n  row.field as Attribute,\n  CASE \n    WHEN row.has_change = false THEN 'âšª No Changes'\n    WHEN row.Base IS NULL THEN 'âœ… Added'\n    WHEN row.Compare IS NULL THEN 'âŒ Removed'\n    ELSE 'ðŸ”„ Modified'\n  END as `Change Type`,\n  coalesce(row.Base, '_null_') as `Base Value`,\n  coalesce(row.Compare, '_null_') as `Compare Value`\nWITH row,`CRF OID`, Level,`Group OID`,`Item OID`,Attribute, `Change Type`,`Base Value`,`Compare Value` \nWHERE `Change Type` = $neodash_type_of_change OR $neodash_type_of_change=''\nRETURN `CRF OID`, Level,`Group OID`,`Item OID`,Attribute, `Change Type`,`Base Value`,`Compare Value`\nORDER BY row.has_change DESC, `Group OID`, row.level DESC, `Item OID`, Attribute\n\n\n",
          "width": 17,
          "height": 9,
          "x": 0,
          "y": 0,
          "type": "table",
          "selection": {},
          "settings": {
            "noDataMessage": "Select CRF versions to compare in CRF Versions tab"
          }
        },
        {
          "id": "d500b960-46da-4413-8dec-94d9cb744641",
          "title": "Summary",
          "query": "\nWITH [\n  {id: $neodash_crf_base_id, version: $neodash_crf_base_version_num, label: 'Base'},\n  {id: $neodash_crf_comp_id, version: $neodash_crf_comp_version_num, label: 'Compare'}\n] AS selections\n\nUNWIND selections AS selection\n\nMATCH (form_root:OdmFormRoot)-[form_version:HAS_VERSION]->(form:OdmFormValue)\nWHERE elementId(form) = selection.id AND form_version.version = selection.version\n\nOPTIONAL MATCH (form)-[:HAS_DESCRIPTION]->(form_desc:OdmDescription)\nOPTIONAL MATCH (form)-[:HAS_ALIAS]->(form_alias:OdmAlias)\nOPTIONAL MATCH (form)-[:ITEM_GROUP_REF]->(group:OdmItemGroupValue)\n//WHERE group.oid = $neodash_group_in_form OR $neodash_group_in_form=''\nOPTIONAL MATCH (group)-[:HAS_DESCRIPTION]->(group_desc:OdmDescription)\nOPTIONAL MATCH (group)-[:HAS_ALIAS]->(group_alias:OdmAlias)\nOPTIONAL MATCH (group)-[:ITEM_REF]->(item:OdmItemValue)\nOPTIONAL MATCH (item)-[:HAS_DESCRIPTION]->(item_desc:OdmDescription)\nOPTIONAL MATCH (item)-[:HAS_ALIAS]->(item_alias:OdmAlias)\n\nWITH selection.label as version_label,\n     form, form.oid as form_oid,\n     group, group.oid as group_oid,\n     item, item.oid as item_oid,\n     apoc.map.mergeList([\n       coalesce(properties(form), {}),\n       CASE WHEN form_desc IS NOT NULL THEN apoc.map.fromPairs([key IN keys(properties(form_desc)) | [\"desc-\" + key, properties(form_desc)[key]]]) ELSE {} END,\n       CASE WHEN form_alias IS NOT NULL THEN apoc.map.fromPairs([key IN keys(properties(form_alias)) | [\"alias-\" + key, properties(form_alias)[key]]]) ELSE {} END\n     ]) AS form_props,\n     apoc.map.mergeList([\n       coalesce(properties(group), {}),\n       CASE WHEN group_desc IS NOT NULL THEN apoc.map.fromPairs([key IN keys(properties(group_desc)) | [\"desc-\" + key, properties(group_desc)[key]]]) ELSE {} END,\n       CASE WHEN group_alias IS NOT NULL THEN apoc.map.fromPairs([key IN keys(properties(group_alias)) | [\"alias-\" + key, properties(group_alias)[key]]]) ELSE {} END\n     ]) AS group_props,\n     apoc.map.mergeList([\n       coalesce(properties(item), {}),\n       CASE WHEN item_desc IS NOT NULL THEN apoc.map.fromPairs([key IN keys(properties(item_desc)) | [\"desc-\" + key, properties(item_desc)[key]]]) ELSE {} END,\n       CASE WHEN item_alias IS NOT NULL THEN apoc.map.fromPairs([key IN keys(properties(item_alias)) | [\"alias-\" + key, properties(item_alias)[key]]]) ELSE {} END\n     ]) AS item_props\n\nWITH version_label, form_oid, group_oid, item_oid,\n     CASE WHEN form IS NOT NULL THEN [{level: 'CRF', oid: form_oid, group_oid: null, form_oid: form_oid, props: form_props}] ELSE [] END +\n     CASE WHEN group IS NOT NULL THEN [{level: 'Group', oid: group_oid, group_oid: group_oid, form_oid: form_oid, props: group_props}] ELSE [] END +\n     CASE WHEN item IS NOT NULL THEN [{level: 'Item', oid: item_oid, group_oid: group_oid, form_oid: form_oid, props: item_props}] ELSE [] END AS all_levels\n\nUNWIND all_levels AS level_data\n\nWITH version_label, \n     level_data.level as level, \n     level_data.oid as oid, \n     level_data.form_oid as form_oid,\n     level_data.group_oid as group_oid,\n     level_data.props as props\n\nUNWIND keys(props) AS field\n\nWITH level, oid, form_oid, group_oid, field,\n  apoc.map.fromPairs(collect([version_label, props[field]])) AS value_map\n\nWITH level, oid, form_oid, group_oid, field,\n  replace(replace(toString(value_map['Base']), '<p>', ''), '</p>', '') AS Base,\n  replace(replace(toString(value_map['Compare']), '<p>', ''), '</p>', '') AS Compare\n\nWITH collect({\n       level: level, \n       oid: oid, \n       form_oid: form_oid, \n       group_oid: group_oid, \n       field: field, \n       Base: Base, \n       Compare: Compare,\n       has_change: (Base <> Compare OR (Base IS NULL AND Compare IS NOT NULL) OR (Base IS NOT NULL AND Compare IS NULL))\n     }) as all_data\n\nWITH all_data,\n     apoc.coll.toSet([d IN all_data WHERE d.has_change = true AND d.level IN ['Group', 'Item'] | d.group_oid]) as groups_with_changes,\n     apoc.coll.toSet([d IN all_data WHERE d.level IN ['Group', 'Item'] | d.group_oid]) as all_groups,\n     size([d IN all_data WHERE d.has_change = true AND d.level = 'CRF']) as crf_changes,\n     size([d IN all_data WHERE d.has_change = true AND d.level = 'Group']) as group_changes,\n     size([d IN all_data WHERE d.has_change = true AND d.level = 'Item']) as item_changes,\n     size([d IN all_data WHERE d.has_change = true AND d.Base IS NULL]) as added_count,\n     size([d IN all_data WHERE d.has_change = true AND d.Compare IS NULL]) as removed_count,\n     size([d IN all_data WHERE d.has_change = true AND d.Base IS NOT NULL AND d.Compare IS NOT NULL]) as modified_count\n\nWITH groups_with_changes, all_groups, crf_changes, group_changes, item_changes, added_count, removed_count, modified_count,\n     [g IN all_groups WHERE NOT g IN groups_with_changes] as groups_without_changes\n\nWITH '# ðŸ“‹ CRF Version Comparison Summary\\n\\n' +\n     '## ð•ðžð«ð¬ð¢ð¨ð§ ðˆð§ðŸð¨ð«ð¦ðšð­ð¢ð¨ð§\\n' +\n     '- ððšð¬ðž ð•ðžð«ð¬ð¢ð¨ð§: ' + toString($neodash_crf_base_version_num) + '\\n' +\n     '- ð‚ð¨ð¦ð©ðšð«ðž ð•ðžð«ð¬ð¢ð¨ð§: ' + toString($neodash_crf_comp_version_num) + '\\n\\n' +\n     '---\\n\\n' +\n     '## ðŽð¯ðžð«ðšð¥ð¥ ð’ð­ðšð­ð¢ð¬ð­ð¢ðœð¬\\n' +\n     '- ð“ð¨ð­ðšð¥ ð†ð«ð¨ð®ð©ð¬ ð€ð§ðšð¥ð²ð³ðžð: ' + toString(size(all_groups)) + '\\n' +\n     '- ð†ð«ð¨ð®ð©ð¬ ð°ð¢ð­ð¡ ð‚ð¡ðšð§ð ðžð¬: ' + toString(size(groups_with_changes)) + '\\n' +\n     '- ð†ð«ð¨ð®ð©ð¬ ð°ð¢ð­ð¡ð¨ð®ð­ ð‚ð¡ðšð§ð ðžð¬: ' + toString(size(groups_without_changes)) + '\\n\\n' +\n     '---\\n\\n' +\n     '## ð‚ð¡ðšð§ð ðžð¬ ð›ð² ð‹ðžð¯ðžð¥\\n' +\n     '- ð‚ð‘ð…-ð¥ðžð¯ðžð¥ ð‚ð¡ðšð§ð ðžð¬: ' + toString(crf_changes) + ' attributes\\n' +\n     '- ð†ð«ð¨ð®ð©-ð¥ðžð¯ðžð¥ ð‚ð¡ðšð§ð ðžð¬: ' + toString(group_changes) + ' attributes\\n' +\n     '- ðˆð­ðžð¦-ð¥ðžð¯ðžð¥ ð‚ð¡ðšð§ð ðžð¬: ' + toString(item_changes) + ' attributes\\n' +\n     '- ð“ð¨ð­ðšð¥ ð‚ð¡ðšð§ð ðžð¬: ' + toString(crf_changes + group_changes + item_changes) + ' attributes\\n\\n' +\n     '---\\n\\n' +\n     '## ð‚ð¡ðšð§ð ðžð¬ ð›ð² ð“ð²ð©ðž\\n' +\n     '- âœ… ð€ðððžð: ' + toString(added_count) + ' attributes\\n' +\n     '- âŒ ð‘ðžð¦ð¨ð¯ðžð: ' + toString(removed_count) + ' attributes\\n' +\n     '- ðŸ”„ ðŒð¨ðð¢ðŸð¢ðžð: ' + toString(modified_count) + ' attributes\\n\\n' +\n     CASE WHEN size(groups_without_changes) > 0 THEN\n       '---\\n\\n' +\n       '## ð†ð«ð¨ð®ð©ð¬ ð°ð¢ð­ð¡ ðð¨ ð‚ð¡ðšð§ð ðžð¬\\n' +\n       apoc.text.join([g IN groups_without_changes | '- ' + g], '\\n') + '\\n'\n     ELSE '' END AS summary\n\nRETURN summary\n\n",
          "width": 6,
          "height": 9,
          "x": 17,
          "y": 0,
          "type": "value",
          "selection": {},
          "settings": {
            "fontSize": 14,
            "monospace": true
          },
          "schema": []
        }
      ]
    },
    {
      "title": "Group Versions",
      "reports": [
        {
          "id": "d900d420-e89f-457b-b6dd-21dea0ac67bf",
          "title": "Group - Select Base",
          "query": "match(group:OdmItemGroupValue)<-[group_version:HAS_VERSION]-(group_root:OdmItemGroupRoot)\nWHERE $neodash_odmitemgroupvalue_oid IS NULL \n   OR $neodash_odmitemgroupvalue_oid = '' \n   OR group.oid = $neodash_odmitemgroupvalue_oid\nreturn group.oid as OID, \ngroup.name as `Name`, \ngroup_version.version as Version, \n'Base' as Select, \nelementId(group) as __group_id,\ngroup_version.version as __group_version\norder by OID, Version",
          "width": 8,
          "height": 5,
          "x": 0,
          "y": 0,
          "type": "table",
          "selection": {},
          "settings": {
            "actionsRules": [
              {
                "condition": "Click",
                "field": "Select",
                "value": "__group_id",
                "customization": "set variable",
                "customizationValue": "group_base_id"
              },
              {
                "condition": "Click",
                "field": "Select",
                "value": "__group_version",
                "customization": "set variable",
                "customizationValue": "group_base_version_num"
              }
            ],
            "compact": true,
            "wrapContent": true,
            "columnWidths": "[1,2,0.5,1]",
            "refreshButtonEnabled": true
          }
        },
        {
          "id": "4dce695c-4b1a-41e1-860c-028463d2bcd9",
          "title": "Group - Select Compare",
          "query": "match(group:OdmItemGroupValue)<-[group_version:HAS_VERSION]-(group_root:OdmItemGroupRoot)\nWHERE $neodash_odmitemgroupvalue_oid IS NULL \n   OR $neodash_odmitemgroupvalue_oid = '' \n   OR group.oid = $neodash_odmitemgroupvalue_oid\nreturn group.oid as OID, \ngroup.name as `Name`, \ngroup_version.version as Version, \n'Compare' as Select, \nelementId(group) as __group_id,\ngroup_version.version as __group_version\norder by OID, Version",
          "width": 8,
          "height": 5,
          "x": 8,
          "y": 0,
          "type": "table",
          "selection": {},
          "settings": {
            "actionsRules": [
              {
                "condition": "Click",
                "field": "Select",
                "value": "__group_id",
                "customization": "set variable",
                "customizationValue": "group_comp_id"
              },
              {
                "condition": "Click",
                "field": "Select",
                "value": "__group_version",
                "customization": "set variable",
                "customizationValue": "group_comp_version_num"
              }
            ],
            "compact": true,
            "wrapContent": true,
            "columnWidths": "[1,2,0.5,1.1]",
            "refreshButtonEnabled": true
          }
        },
        {
          "id": "c5614468-1139-42d5-a080-0ee57115cb79",
          "title": "Group Attributes differences",
          "query": "MATCH (group:OdmItemGroupValue)<-[:HAS_VERSION]-(group_root:OdmItemGroupRoot) \nWHERE elementId(group) IN [$neodash_group_base_id, $neodash_group_comp_id]\nWITH CASE WHEN count(DISTINCT group_root) > 1 THEN 'Across Group' ELSE 'Within Group' END AS compare_type\nWITH compare_type, [\n  {id: $neodash_group_base_id, version: $neodash_group_base_version_num, label: 'Base'},\n  {id: $neodash_group_comp_id, version: $neodash_group_comp_version_num, label: 'Compare'}\n] AS selections\nUNWIND selections AS selection\nMATCH (group:OdmItemGroupValue)<-[group_version:HAS_VERSION]-(group_root:OdmItemGroupRoot) \nWHERE elementId(group) = selection.id \n  AND group_version.version = selection.version\nOPTIONAL MATCH (group)-[r1_2:HAS_DESCRIPTION]->(group_desc:OdmDescription)\nOPTIONAL MATCH (group)-[r1_3:HAS_ALIAS]->(group_alias:OdmAlias)\nWITH DISTINCT\n  selection.label as group_compare,\n  group,\n  group_version,\n  CASE\n    WHEN\n      group_alias IS NOT NULL\n      THEN\n        apoc.map.fromPairs(\n          [\n            key IN keys(properties(group_alias))\n            | [\"alias-\" + key, properties(group_alias)[key]]\n          ])\n    ELSE null\n  END AS aliasMap,\n  CASE\n    WHEN\n      group_desc IS NOT NULL\n      THEN\n        apoc.map.fromPairs(\n          [\n            key IN keys(properties(group_desc))\n            | [\"desc-\" + key, properties(group_desc)[key]]\n          ])\n    ELSE null\n  END AS descMap,\n  properties(group) AS groupMap\nWITH\n  group_compare,\n  group,\n  group_version,\n  apoc.map.merge(groupMap, apoc.map.merge(descMap, aliasMap)) AS props_map\nWITH group_compare,\n  group,\n  group_version, props_map\nUNWIND keys(props_map) AS field\nWITH\n  group.oid AS OID,\n  field,\n  apoc.map.fromPairs(collect([group_compare, props_map[field]])) AS value_map\nWITH\n  OID AS `Group OID`,\n  CASE WHEN field contains 'desc-' THEN '2Description' ELSE \n  CASE WHEN field contains 'alias-' THEN '3Alias' ELSE '1Identification' END END as area,\n  CASE WHEN (field contains 'desc-') OR (field contains 'alias-') THEN split(field, '-')[1]  ELSE field END AS `Group attribute`,\n  replace(replace(toString(value_map['Base']), '<p>', ''), '</p>', '')   AS Base,\n  replace(replace(toString(value_map['Compare']), '<p>', ''), '</p>', '')  AS Compare\nORDER BY `Group OID`, area, `Group attribute`\nWITH `Group OID`,area, `Group attribute`, Base, Compare, \nCASE WHEN Base = Compare THEN 'N' ELSE CASE WHEN Base is null and Compare is null THEN 'N' ELSE 'Y' END END as __diff,\nCASE \n    WHEN Base = Compare THEN 'âšª No Changes'\n    WHEN Base IS NULL THEN 'âœ… Added'\n    WHEN Compare IS NULL THEN 'âŒ Removed'\n    ELSE 'ðŸ”„ Modified'\nEND AS `Change Type`\nRETURN `Group OID`, substring(area,1) as Area, `Group attribute`, Base, Compare, `Change Type`, __diff",
          "width": 16,
          "height": 4,
          "x": 8,
          "y": 5,
          "type": "table",
          "selection": {},
          "settings": {
            "compact": true,
            "wrapContent": true,
            "columnWidths": "[1,1,1,2,2]",
            "styleRules": [
              {
                "field": "__diff",
                "condition": "=",
                "value": "Y",
                "customization": "row color",
                "customizationValue": "#FF11116E"
              },
              {
                "field": "__diff",
                "condition": "=",
                "value": "N",
                "customization": "row color",
                "customizationValue": "#5FE8866E"
              }
            ],
            "fullscreenEnabled": true,
            "allowDownload": true
          }
        },
        {
          "id": "5a5e2571-f1e6-4dd6-9f7b-b75c0990a4ad",
          "title": "Selected Group versions",
          "query": "MATCH (group:OdmItemGroupValue)<-[:HAS_VERSION]-(group_root:OdmItemGroupRoot) \nWHERE elementId(group) IN [$neodash_group_base_id, $neodash_group_comp_id]\nWITH CASE WHEN count(DISTINCT group_root) > 1 THEN 'Across Group' ELSE 'Within Group' END AS compare_type\n\nWITH compare_type, [\n  {id: $neodash_group_base_id, version: $neodash_group_base_version_num, label: 'Base'},\n  {id: $neodash_group_comp_id, version: $neodash_group_comp_version_num, label: 'Compare'}\n] AS selections\n\nUNWIND selections AS selection\n\nMATCH (group:OdmItemGroupValue)<-[group_version:HAS_VERSION]-(group_root:OdmItemGroupRoot) \nWHERE elementId(group) = selection.id \n  AND group_version.version = selection.version\n\nRETURN \n  selection.label as `Group Selection`,\n  group.oid as OID, \n  group.name as Name, \n  group_version.version as Version, \n  compare_type as `Compare Type`\nORDER BY OID, Version, `Group Selection`",
          "width": 8,
          "height": 3,
          "x": 16,
          "y": 2,
          "type": "table",
          "selection": {},
          "settings": {
            "refreshButtonEnabled": true,
            "transposed": true,
            "compact": true
          }
        },
        {
          "id": "6df2a57c-f04d-4182-b777-08322a42d7b6",
          "title": "Filter Group",
          "query": "MATCH (n:`OdmItemGroupValue`) \nWHERE toLower(toString(n.`oid`)) CONTAINS toLower($input) \nRETURN DISTINCT n.`oid` as value,  n.`name` as display ORDER BY size(toString(value)) ASC LIMIT 1000",
          "width": 8,
          "height": 2,
          "x": 16,
          "y": 0,
          "type": "select",
          "selection": {},
          "settings": {
            "type": "Custom Query",
            "refreshButtonEnabled": true,
            "multiline": false,
            "overridePropertyDisplayName": false,
            "suggestionLimit": 1000,
            "manualPropertyNameSpecification": true,
            "helperText": "Filter Group (optional)",
            "multiSelectLimit": 100,
            "entityType": "odmitemgroupvalue_oid",
            "parameterName": "neodash_odmitemgroupvalue_oid"
          },
          "schema": []
        },
        {
          "id": "b641654f-0d3f-47dc-9cfc-f38a201ecd59",
          "title": "In collection(s)",
          "query": "MATCH (group:OdmItemGroupValue)<-[:HAS_VERSION]-(group_root:OdmItemGroupRoot) \nWHERE elementId(group) IN [$neodash_group_base_id, $neodash_group_comp_id]\nWITH CASE WHEN count(DISTINCT group_root) > 1 THEN 'Across Group' ELSE 'Within Group' END AS compare_type\n\nWITH compare_type, [\n  {id: $neodash_group_base_id, version: $neodash_group_base_version_num, label: 'Base'},\n  {id: $neodash_group_comp_id, version: $neodash_group_comp_version_num, label: 'Compare'}\n] AS selections\n\nUNWIND selections AS selection\n\nMATCH (group:OdmItemGroupValue)<-[group_version:HAS_VERSION]-(group_root:OdmItemGroupRoot) \nWHERE elementId(group) = selection.id \n  AND group_version.version = selection.version\nOPTIONAL MATCH (coll_root:OdmStudyEventRoot)-[coll_version:HAS_VERSION]->(coll:OdmStudyEventValue)-[r1_1:FORM_REF]->(form:OdmFormValue)-[r1_4:ITEM_GROUP_REF]->(group)\nWITH DISTINCT selection.label as group_compare, collect(DISTINCT coll.name+'-V'+coll_version.version) AS coll\nWITH apoc.map.fromPairs(collect([group_compare, coll])) AS data\nWITH data, \n     CASE WHEN size(data.Base) > size(data.Compare) \n          THEN size(data.Base) \n          ELSE size(data.Compare) \n     END AS maxSize\nUNWIND CASE WHEN maxSize IS NULL OR maxSize = 0 \n            THEN [0] \n            ELSE range(0, maxSize - 1) \n       END AS idx\nRETURN CASE WHEN maxSize > 0 AND idx < size(data.Base) THEN data.Base[idx] END AS Base,\n       CASE WHEN maxSize > 0 AND idx < size(data.Compare) THEN data.Compare[idx] END AS Compare",
          "width": 8,
          "height": 4,
          "x": 0,
          "y": 5,
          "type": "table",
          "selection": {},
          "settings": {
            "refreshButtonEnabled": true,
            "compact": true,
            "wrapContent": true,
            "transposed": false
          }
        },
        {
          "id": "5e9eddc6-9579-4143-aa08-da7522dd86d7",
          "title": "Item Count",
          "query": "MATCH (group:OdmItemGroupValue)<-[:HAS_VERSION]-(group_root:OdmItemGroupRoot) \nWHERE elementId(group) IN [$neodash_group_base_id, $neodash_group_comp_id]\nWITH CASE WHEN count(DISTINCT group_root) > 1 THEN 'Across Group' ELSE 'Within Group' END AS compare_type\n\nWITH compare_type, [\n  {id: $neodash_group_base_id, version: $neodash_group_base_version_num, label: 'Base'},\n  {id: $neodash_group_comp_id, version: $neodash_group_comp_version_num, label: 'Compare'}\n] AS selections\n\nUNWIND selections AS selection\n\nMATCH (group:OdmItemGroupValue)<-[group_version:HAS_VERSION]-(group_root:OdmItemGroupRoot) \nWHERE elementId(group) = selection.id \n  AND group_version.version = selection.version\nWITH selection.label as group_compare,group, group_version where selection.version in[$neodash_group_base_version_num, $neodash_group_comp_version_num]\nOPTIONAL MATCH (group)-[:ITEM_REF]->(item:OdmItemValue)\nRETURN  \n      group_compare+'-V'+toString(group_version.version) AS version,\n        toInteger(COUNT(DISTINCT item)) AS `Item count`,\n        'ITEM_COUNT' AS metric_type\nORDER BY version",
          "width": 8,
          "height": 6,
          "x": 0,
          "y": 9,
          "type": "bar",
          "selection": {
            "index": "version",
            "value": "Item count",
            "key": "(none)"
          },
          "settings": {
            "showOptionalSelections": false,
            "refreshButtonEnabled": true,
            "legend": false,
            "hideSelections": true,
            "innerPadding": 10,
            "displayYGridLines": false,
            "labelRotation": 0,
            "barValues": true,
            "displayYAxis": false,
            "colors": "category10"
          },
          "schema": []
        },
        {
          "id": "d028ea6c-7fdb-4aca-9957-6e518a9e9722",
          "title": "Item Attributes differences - $neodash_select_group_2",
          "query": "MATCH (group:OdmItemGroupValue)<-[:HAS_VERSION]-(group_root:OdmItemGroupRoot) \nWHERE elementId(group) IN [$neodash_group_base_id, $neodash_group_comp_id]\nWITH CASE WHEN count(DISTINCT group_root) > 1 THEN 'Across Group' ELSE 'Within Group' END AS compare_type\nWITH compare_type, [\n  {id: $neodash_group_base_id, version: $neodash_group_base_version_num, label: 'Base'},\n  {id: $neodash_group_comp_id, version: $neodash_group_comp_version_num, label: 'Compare'}\n] AS selections\nUNWIND selections AS selection\nMATCH (group:OdmItemGroupValue)<-[group_version:HAS_VERSION]-(group_root:OdmItemGroupRoot) \nWHERE elementId(group) = selection.id \n  AND group_version.version = selection.version\n  //Get the item in the group on the form and the item details\noptional match(group)-[r3_1:ITEM_REF]->(item:OdmItemValue)<-[item_version:HAS_VERSION]-(item_root:OdmItemRoot)\noptional match(item)-[r3_2:HAS_DESCRIPTION]->(item_desc:OdmDescription)\noptional match(item)-[r3_3:HAS_ALIAS]->(item_alias:OdmAlias)\noptional match(item)-[r3_4:HAS_CODELIST_TERM]->(i_context:CTTermContext)-[r3_5:HAS_SELECTED_TERM]->(i_term_root:CTTermRoot)<-[r3_6:HAS_TERM_ROOT]-(item_term:CTCodelistTerm)\nWITH DISTINCT\n  selection.label as group_compare,\n  group_version,\n  group,\n  item,\n  CASE\n    WHEN\n      item_alias IS NOT NULL\n      THEN\n        apoc.map.fromPairs(\n          [\n            key IN keys(properties(item_alias))\n            | [\"alias-\" + key, properties(item_alias)[key]]\n          ])\n    ELSE null\n  END AS aliasMap,\n  CASE\n    WHEN\n      item_desc IS NOT NULL\n      THEN\n        apoc.map.fromPairs(\n          [\n            key IN keys(properties(item_desc))\n            | [\"desc-\" + key, properties(item_desc)[key]]\n          ])\n    ELSE null\n  END AS descMap,\n  // Domain map\n    CASE\n    WHEN\n      item_term IS NOT NULL\n      THEN\n        apoc.map.fromPairs(\n          [\n            key IN keys(properties(item_term))\n            | [\"itemterm-\" + key, properties(item_term)[key]]\n          ])\n    ELSE null\n  END AS itemTermMap,\n  properties(item) AS itemMap\nWITH \n  group_compare,\n  group_version,\n  group,\n  item,\n  itemMap,\n  descMap,\n  aliasMap,\n  collect(itemTermMap) as itemTermMaps\nWITH \n  group_compare,\n  group_version,\n  group,\n  item,\n  itemMap,\n  descMap,\n  aliasMap,\n  CASE WHEN size(itemTermMaps)>0 THEN {`itemterm-submission_value`: apoc.text.join([map IN itemTermMaps WHERE size(keys(map))>0 | map.`itemterm-submission_value`], \";\")} ELSE {} END AS itemTermMap\nWITH group_compare,\n  group_version,\n  group,\n  item,\n  apoc.map.merge(itemMap, apoc.map.merge(descMap, apoc.map.merge(aliasMap,itemTermMap))) AS props_map\nWITH group_compare,\n  group_version,\n  group,\n  item, props_map\nUNWIND keys(props_map) AS field\nWITH DISTINCT\n  group.oid as gOID,\n  item.oid as iOID,\n  field,\n  apoc.map.fromPairs(collect([group_compare, props_map[field]])) AS value_map\nWITH DISTINCT\n  gOID as `Group OID`,\n  iOID as `Item OID`,\n  CASE WHEN field contains 'desc-' THEN '2Description' ELSE \n  CASE WHEN field contains 'alias-' THEN '3Alias' ELSE \n  CASE WHEN field contains 'itemterm-' THEN '4Terms' ELSE '1Identification' END END END as area,\n  CASE WHEN (field contains 'desc-') OR (field contains 'alias-') OR (field contains 'domain-') OR (field contains 'itemterm-') THEN split(field, '-')[1]  ELSE field END AS `Item attribute`,\n  replace(replace(toString(value_map['Base']), '<p>', ''), '</p>', '')   AS Base,\n  replace(replace(toString(value_map['Compare']), '<p>', ''), '</p>', '')  AS Compare\nORDER BY `Group OID`, `Item OID`, area, `Item attribute`\nWITH DISTINCT `Group OID`, `Item OID`, area, `Item attribute`, Base, Compare, \nCASE WHEN Base = Compare THEN 'N' ELSE CASE WHEN Base is null and Compare is null THEN 'N' ELSE 'Y' END END as __diff,\nCASE \n    WHEN Base = Compare THEN 'âšª No Changes'\n    WHEN Base IS NULL THEN 'âœ… Added'\n    WHEN Compare IS NULL THEN 'âŒ Removed'\n    ELSE 'ðŸ”„ Modified'\nEND AS `Change Type`\nRETURN `Item OID`, substring(area,1) as Area, `Item attribute`, Base, Compare, `Change Type`, __diff",
          "width": 16,
          "height": 6,
          "x": 8,
          "y": 9,
          "type": "table",
          "selection": {},
          "settings": {
            "refreshButtonEnabled": true,
            "compact": true,
            "wrapContent": true,
            "styleRules": [
              {
                "field": "__diff",
                "condition": "=",
                "value": "Y",
                "customization": "row color",
                "customizationValue": "#FF11116E"
              },
              {
                "field": "__diff",
                "condition": "=",
                "value": "N",
                "customization": "row color",
                "customizationValue": "#5FE8866E"
              }
            ],
            "fullscreenEnabled": true,
            "allowDownload": true
          }
        }
      ]
    },
    {
      "title": "Item Versions",
      "reports": [
        {
          "id": "d900d420-e89f-457b-b6dd-21dea0ac67bf",
          "title": "Item - Select Base",
          "query": "match(item:OdmItemValue)<-[item_version:HAS_VERSION]-(item_root:OdmItemRoot)\nWHERE $neodash_odmitemvalue_oid IS NULL \n   OR $neodash_odmitemvalue_oid = '' \n   OR item.oid = $neodash_odmitemvalue_oid\nreturn item.oid as OID, \nitem.name as `Name`, \nitem_version.version as Version, \n'Base' as Select, \nelementId(item) as __item_id,\nitem_version.version as __item_version\norder by OID, Version",
          "width": 8,
          "height": 5,
          "x": 0,
          "y": 0,
          "type": "table",
          "selection": {},
          "settings": {
            "actionsRules": [
              {
                "condition": "Click",
                "field": "Select",
                "value": "__item_id",
                "customization": "set variable",
                "customizationValue": "item_base_id"
              },
              {
                "condition": "Click",
                "field": "Select",
                "value": "__item_version",
                "customization": "set variable",
                "customizationValue": "item_base_version_num"
              }
            ],
            "compact": true,
            "wrapContent": true,
            "columnWidths": "[1,2,0.5,1]",
            "refreshButtonEnabled": true
          }
        },
        {
          "id": "4dce695c-4b1a-41e1-860c-028463d2bcd9",
          "title": "Item - Select Compare",
          "query": "match(item:OdmItemValue)<-[item_version:HAS_VERSION]-(item_root:OdmItemRoot)\nWHERE $neodash_odmitemvalue_oid IS NULL \n   OR $neodash_odmitemvalue_oid = '' \n   OR item.oid = $neodash_odmitemvalue_oid\nreturn item.oid as OID, \nitem.name as `Name`, \nitem_version.version as Version, \n'Compare' as Select, \nelementId(item) as __item_id,\nitem_version.version as __item_version\norder by OID, Version",
          "width": 8,
          "height": 5,
          "x": 8,
          "y": 0,
          "type": "table",
          "selection": {},
          "settings": {
            "actionsRules": [
              {
                "condition": "Click",
                "field": "Select",
                "value": "__item_id",
                "customization": "set variable",
                "customizationValue": "item_comp_id"
              },
              {
                "condition": "Click",
                "field": "Select",
                "value": "__item_version",
                "customization": "set variable",
                "customizationValue": "item_comp_version_num"
              }
            ],
            "compact": true,
            "wrapContent": true,
            "columnWidths": "[1,2,0.5,1.1]",
            "refreshButtonEnabled": true
          }
        },
        {
          "id": "c5614468-1139-42d5-a080-0ee57115cb79",
          "title": "Item Attributes differences - (v $neodash_item_base_version_num â†’ v $neodash_item_comp_version_num)",
          "query": "MATCH (item:OdmItemValue)<-[:HAS_VERSION]-(item_root:OdmItemRoot) \nWHERE elementId(item) IN [$neodash_item_base_id, $neodash_item_comp_id]\nWITH CASE WHEN count(DISTINCT item_root) > 1 THEN 'Across Item' ELSE 'Within Item' END AS compare_type\n\nWITH compare_type, [\n  {id: $neodash_item_base_id, version: $neodash_item_base_version_num, label: 'Base'},\n  {id: $neodash_item_comp_id, version: $neodash_item_comp_version_num, label: 'Compare'}\n] AS selections\n\nUNWIND selections AS selection\nMATCH (item:OdmItemValue)<-[item_version:HAS_VERSION]-(item_root:OdmItemRoot) \nWHERE elementId(item) = selection.id \n  AND item_version.version = selection.version\noptional match(item)-[r3_2:HAS_DESCRIPTION]->(item_desc:OdmDescription)\noptional match(item)-[r3_3:HAS_ALIAS]->(item_alias:OdmAlias)\noptional match(item)-[r3_4:HAS_CODELIST_TERM]->(i_context:CTTermContext)-[r3_5:HAS_SELECTED_TERM]->(i_term_root:CTTermRoot)<-[r3_6:HAS_TERM_ROOT]-(item_term:CTCodelistTerm)\noptional match(item)-[r3_7:HAS_VENDOR_ELEMENT]->(i_ext_elem:OdmVendorElementValue)<-[r3_8:HAS_VENDOR_ELEMENT]-(i_elem_vendor_ns:OdmVendorNamespaceValue)<-[i_elem_vendor_ns_version:HAS_VERSION]-(),(i_ext_elem)<-[i_ext_elem_version:HAS_VERSION]-()\noptional match(item)-[value1:HAS_VENDOR_ATTRIBUTE]->(i_ext_att:OdmVendorAttributeValue)<-[r3_10:HAS_VENDOR_ATTRIBUTE]-(i_att_vendor_ns:OdmVendorNamespaceValue)<-[i_att_vendor_ns_version:HAS_VERSION]-(),(i_ext_att)<-[i_ext_att_version:HAS_VERSION]-()\noptional match(item)-[value2:HAS_VENDOR_ELEMENT_ATTRIBUTE]->(i_att_val:OdmVendorAttributeValue)<-[r3_12:HAS_VENDOR_ATTRIBUTE]-(i_ext_elem)\nWITH DISTINCT\n  selection.label as item_compare,\n  item,\n  value1,\n  CASE\n    WHEN\n      item_alias IS NOT NULL\n      THEN\n        apoc.map.fromPairs(\n          [\n            key IN keys(properties(item_alias))\n            | [\"alias-\" + key, properties(item_alias)[key]]\n          ])\n    ELSE {}\n  END AS aliasMap,\n  CASE\n    WHEN\n      item_desc IS NOT NULL\n      THEN\n        apoc.map.fromPairs(\n          [\n            key IN keys(properties(item_desc))\n            | [\"desc-\" + key, properties(item_desc)[key]]\n          ])\n    ELSE {}\n  END AS descMap,\n  // Domain map\n    CASE\n    WHEN\n      item_term IS NOT NULL\n      THEN\n        apoc.map.fromPairs(\n          [\n            key IN keys(properties(item_term))\n            | [\"itemterm-\" + key, properties(item_term)[key]]\n          ])\n    ELSE {}\n  END AS itemTermMap,\nCASE\n  WHEN i_ext_elem IS NOT NULL AND i_ext_elem_version IS NOT NULL\n    THEN apoc.map.fromPairs([key IN keys(properties(i_ext_elem)) | [\"elemExt-\" + key, properties(i_ext_elem)[key]+'(V'+i_ext_elem_version.version+')']])\n  ELSE {}\nEND AS i_ext_elemMap,\nCASE\n  WHEN i_ext_att IS NOT NULL AND i_ext_att_version IS NOT NULL\n    THEN apoc.map.fromPairs([key IN keys(properties(i_ext_att)) | [\"attExt-\" + key, properties(i_ext_att)[key]+'(V'+i_ext_att_version.version+')']])\n  ELSE {}\nEND AS i_ext_attMap,\nCASE\n  WHEN i_att_val IS NOT NULL AND i_ext_elem_version IS NOT NULL\n    THEN apoc.map.fromPairs([key IN keys(properties(i_att_val)) | [\"elem_attExt-\" + key, properties(i_att_val)[key]+'(V'+i_ext_elem_version.version+')']])\n  ELSE {}\nEND AS i_ext_attMap2,\nCASE\n  WHEN i_elem_vendor_ns IS NOT NULL AND i_elem_vendor_ns_version IS NOT NULL\n    THEN apoc.map.fromPairs([key IN keys(properties(i_elem_vendor_ns)) | [\"elem_nsExt-\" + key, properties(i_elem_vendor_ns)[key]+'(V'+i_elem_vendor_ns_version.version+')']])\n  ELSE {}\nEND AS i_elem_vendor_nsMap,\nCASE\n  WHEN i_att_vendor_ns IS NOT NULL AND i_att_vendor_ns_version IS NOT NULL\n    THEN apoc.map.fromPairs([key IN keys(properties(i_att_vendor_ns)) | [\"att_nsExt-\" + key, properties(i_att_vendor_ns)[key]+'(V'+i_att_vendor_ns_version.version+')']])\n  ELSE {}\nEND AS i_att_vendor_nsMap,\nCASE\n  WHEN properties(value1) IS NOT NULL \n    THEN apoc.map.fromPairs([key IN keys(properties(value1)) | [\"attExt-\" + key, properties(value1)[key]]])\n  ELSE {}\nEND AS value1Map,\nCASE\n  WHEN properties(value2) IS NOT NULL \n    THEN apoc.map.fromPairs([key IN keys(properties(value2)) | [\"elem_attExt-\" + key, properties(value2)[key]]])\n  ELSE {}\nEND AS value2Map,\n  coalesce(properties(item), {}) AS itemMap\nWITH DISTINCT\n  item_compare,\n  item,\n  itemMap,\n  descMap,\n  aliasMap,\n  i_ext_elemMap,\n  apoc.map.merge(i_ext_attMap,value1Map) as value_i_ext_attMap,\n  i_elem_vendor_nsMap,\n  i_att_vendor_nsMap,\n  apoc.map.merge(i_ext_attMap2,value2Map) as value_i_elem_attMap2,\n  collect(distinct itemTermMap) as itemTermMaps\nWITH\n  item_compare,\n  item,\n  collect(itemMap) as itemMap,\n  collect(descMap) as descMap,\n  collect(aliasMap) as aliasMap,\n  collect(i_ext_elemMap) as i_ext_elemMap,\n  collect(i_elem_vendor_nsMap) as i_elem_vendor_nsMap,\n  collect(i_att_vendor_nsMap) as i_att_vendor_nsMap,\n  collect(value_i_ext_attMap) as value_i_ext_attMap ,\n  collect(value_i_elem_attMap2) as value_i_elem_attMap2 ,\n  collect({`itemterm-submission_value`: apoc.text.join([map IN itemTermMaps | map.`itemterm-submission_value`], \";\")}) AS itemTermMap\nWITH\n  item_compare,\n  item,\n  itemMap+descMap+aliasMap+itemTermMap+i_att_vendor_nsMap+i_elem_vendor_nsMap+i_ext_elemMap+value_i_elem_attMap2+value_i_ext_attMap AS props_maps\nUNWIND props_maps as props_map\nUNWIND keys(props_map) AS field\nWITH DISTINCT\n  item.oid as iOID,\n  field,\n  //adding props_map here to get all values\n  //props_map,\n  apoc.map.fromPairs(collect(distinct [item_compare, props_map[field]])) AS value_map\nWITH DISTINCT\n  iOID as `Item OID`,\n  CASE split(field, '-')[0]\n  WHEN 'elem_nsExt' THEN '9VendorExt(NameSpace for Element)'\n  WHEN 'elem_attExt' THEN '8VendorExt(Attribute for Element)'\n  WHEN 'elemExt' THEN '7VendorExt(Element)'\n  WHEN 'att_nsExt' THEN '6VendorExt(NameSpace for Attribute)'\n  WHEN 'attExt' THEN '5VendorExt(Attribute)'\n  WHEN 'itemterm' THEN '4Terms'\n  WHEN 'alias' THEN '3Alias'\n  WHEN 'desc' THEN '2Description'\n  ELSE '1Identification'\nEND AS area,\n  CASE WHEN split(field, '-')[0] IN ['desc', 'alias', 'itemterm', 'attExt','elem_attExt','elemExt','elem_nsExt','att_nsExt']\n     THEN split(field, '-')[1]  \n     ELSE field\nEND AS `Item attribute`,\nreplace(replace(toString(value_map['Base']), '<p>', ''), '</p>', '')   AS Base,\nreplace(replace(toString(value_map['Compare']), '<p>', ''), '</p>', '')  AS Compare\nORDER BY `Item OID`, area, `Item attribute`\nWITH DISTINCT `Item OID`, area, `Item attribute`, Base, Compare,\nCASE WHEN Base = Compare THEN 'N' ELSE CASE WHEN Base is null and Compare is null THEN 'N' ELSE 'Y' END END as __diff,\nCASE \n    WHEN Base = Compare THEN 'âšª No Changes'\n    WHEN Base IS NULL THEN 'âœ… Added'\n    WHEN Compare IS NULL THEN 'âŒ Removed'\n    ELSE 'ðŸ”„ Modified'\nEND AS `Change Type`\nWITH DISTINCT `Item OID`,substring(area,1) as Area, `Item attribute`, Base, Compare, `Change Type`, __diff\nRETURN `Item OID`, Area, `Item attribute`, Base, Compare, `Change Type`, __diff",
          "width": 24,
          "height": 4,
          "x": 0,
          "y": 5,
          "type": "table",
          "selection": {},
          "settings": {
            "compact": true,
            "wrapContent": true,
            "columnWidths": "[0.5,1.5,1,2,2]",
            "styleRules": [
              {
                "field": "__diff",
                "condition": "=",
                "value": "Y",
                "customization": "row color",
                "customizationValue": "#FF11116E"
              },
              {
                "field": "__diff",
                "condition": "=",
                "value": "N",
                "customization": "row color",
                "customizationValue": "#5FE8866E"
              }
            ],
            "refreshButtonEnabled": true,
            "fullscreenEnabled": true,
            "allowDownload": true
          }
        },
        {
          "id": "5a5e2571-f1e6-4dd6-9f7b-b75c0990a4ad",
          "title": "Selected Item versions",
          "query": "MATCH (item:OdmItemValue)<-[:HAS_VERSION]-(item_root:OdmItemRoot) \nWHERE elementId(item) IN [$neodash_item_base_id, $neodash_item_comp_id]\nWITH CASE WHEN count(DISTINCT item_root) > 1 THEN 'Across Item' ELSE 'Within Item' END AS compare_type\n\nWITH compare_type, [\n  {id: $neodash_item_base_id, version: $neodash_item_base_version_num, label: 'Base'},\n  {id: $neodash_item_comp_id, version: $neodash_item_comp_version_num, label: 'Compare'}\n] AS selections\n\nUNWIND selections AS selection\n\nMATCH (item:OdmItemValue)<-[item_version:HAS_VERSION]-(item_root:OdmItemRoot) \nWHERE elementId(item) = selection.id \n  AND item_version.version = selection.version\n\nRETURN \n  selection.label as `Item Selection`,\n  item.oid as OID, \n  item.name as Name, \n  item_version.version as Version, \n  compare_type as `Compare Type`\nORDER BY OID, Version, `Item Selection`",
          "width": 8,
          "height": 3,
          "x": 16,
          "y": 2,
          "type": "table",
          "selection": {},
          "settings": {
            "refreshButtonEnabled": true,
            "transposed": true,
            "compact": true
          }
        },
        {
          "id": "6df2a57c-f04d-4182-b777-08322a42d7b6",
          "title": "Filter Item",
          "query": "MATCH (n:`OdmItemValue`) \nWHERE toLower(toString(n.`oid`)) CONTAINS toLower($input) \nRETURN DISTINCT n.`oid` as value,  n.`name` as display ORDER BY size(toString(value)) ASC LIMIT 1000",
          "width": 8,
          "height": 2,
          "x": 16,
          "y": 0,
          "type": "select",
          "selection": {},
          "settings": {
            "type": "Custom Query",
            "refreshButtonEnabled": true,
            "multiline": false,
            "overridePropertyDisplayName": false,
            "suggestionLimit": 1000,
            "manualPropertyNameSpecification": true,
            "helperText": "Filter Item (optional)",
            "multiSelectLimit": 100,
            "entityType": "odmitemvalue_oid",
            "parameterName": "neodash_odmitemvalue_oid"
          },
          "schema": []
        },
        {
          "id": "b641654f-0d3f-47dc-9cfc-f38a201ecd59",
          "title": "Item in collection(s) - ( v $neodash_item_base_version_num â†’ v $neodash_item_comp_version_num)",
          "query": "MATCH (item:OdmItemValue)<-[:HAS_VERSION]-(item_root:OdmItemRoot) \nWHERE elementId(item) IN [$neodash_item_base_id, $neodash_item_comp_id]\nWITH CASE WHEN count(DISTINCT item_root) > 1 THEN 'Across Item' ELSE 'Within Item' END AS compare_type\n\nWITH compare_type, [\n  {id: $neodash_item_base_id, version: $neodash_item_base_version_num, label: 'Base'},\n  {id: $neodash_item_comp_id, version: $neodash_item_comp_version_num, label: 'Compare'}\n] AS selections\n\nUNWIND selections AS selection\nMATCH (item:OdmItemValue)<-[item_version:HAS_VERSION]-(item_root:OdmItemRoot) \nWHERE elementId(item) = selection.id \n  AND item_version.version = selection.version\nOPTIONAL MATCH (coll_root:OdmStudyEventRoot)-[coll_version:HAS_VERSION]->(coll:OdmStudyEventValue)-[r1_1:FORM_REF]->(form:OdmFormValue)-[r1_4:ITEM_GROUP_REF]->(group:OdmItemGroupValue)-[r3_1:ITEM_REF]->(item)\nWITH selection.label as item_compare, coll.name as coll_name, coll_version.version as coll_version order by coll_name, coll_version\nWITH DISTINCT item_compare, collect(DISTINCT coll_name+'(V'+coll_version+')') AS coll\nWITH apoc.map.fromPairs(collect([item_compare, coll])) AS data\nWITH data, \n     CASE WHEN size(data.Base) > size(data.Compare) \n          THEN size(data.Base) \n          ELSE size(data.Compare) \n     END AS maxSize\nUNWIND CASE WHEN maxSize IS NULL OR maxSize = 0 \n            THEN [0] \n            ELSE range(0, maxSize - 1) \n       END AS idx\nRETURN CASE WHEN maxSize > 0 AND idx < size(data.Base) THEN data.Base[idx] END AS Base,\n       CASE WHEN maxSize > 0 AND idx < size(data.Compare) THEN data.Compare[idx] END AS Compare\n",
          "width": 8,
          "height": 3,
          "x": 0,
          "y": 9,
          "type": "table",
          "selection": {},
          "settings": {
            "refreshButtonEnabled": true,
            "compact": true,
            "wrapContent": true,
            "transposed": false
          }
        },
        {
          "id": "829a1e54-0699-453b-bd29-d1ab6087cda0",
          "title": "Item in CRF(s)-  ( v $neodash_item_base_version_num â†’ v $neodash_item_comp_version_num)",
          "query": "MATCH (item:OdmItemValue)<-[:HAS_VERSION]-(item_root:OdmItemRoot) \nWHERE elementId(item) IN [$neodash_item_base_id, $neodash_item_comp_id]\nWITH CASE WHEN count(DISTINCT item_root) > 1 THEN 'Across Item' ELSE 'Within Item' END AS compare_type\n\nWITH compare_type, [\n  {id: $neodash_item_base_id, version: $neodash_item_base_version_num, label: 'Base'},\n  {id: $neodash_item_comp_id, version: $neodash_item_comp_version_num, label: 'Compare'}\n] AS selections\n\nUNWIND selections AS selection\nMATCH (item:OdmItemValue)<-[item_version:HAS_VERSION]-(item_root:OdmItemRoot) \nWHERE elementId(item) = selection.id \n  AND item_version.version = selection.version\nOPTIONAL MATCH ()-[form_version:HAS_VERSION]->(form:OdmFormValue)-[r1_4:ITEM_GROUP_REF]->(group:OdmItemGroupValue)-[r3_1:ITEM_REF]->(item)\nWITH selection.label as item_compare, form.name as name, form_version.version as version order by name, version\nWITH DISTINCT item_compare, collect(DISTINCT name+'(V'+version+')') AS form\nWITH apoc.map.fromPairs(collect([item_compare, form])) AS data\nWITH data, \n     CASE WHEN size(data.Base) > size(data.Compare) \n          THEN size(data.Base) \n          ELSE size(data.Compare) \n     END AS maxSize\nUNWIND CASE WHEN maxSize IS NULL OR maxSize = 0 \n            THEN [0] \n            ELSE range(0, maxSize - 1) \n       END AS idx\nRETURN CASE WHEN maxSize > 0 AND idx < size(data.Base) THEN data.Base[idx] END AS Base,\n       CASE WHEN maxSize > 0 AND idx < size(data.Compare) THEN data.Compare[idx] END AS Compare",
          "width": 8,
          "height": 3,
          "x": 8,
          "y": 9,
          "type": "table",
          "selection": {},
          "settings": {
            "refreshButtonEnabled": true,
            "compact": true,
            "wrapContent": true,
            "transposed": false
          }
        },
        {
          "id": "64df0f2d-1969-4343-9e9c-1d9ae9a075b8",
          "title": "Item in Groups(s) - ( v $neodash_item_base_version_num â†’ v $neodash_item_comp_version_num)",
          "query": "MATCH (item:OdmItemValue)<-[:HAS_VERSION]-(item_root:OdmItemRoot) \nWHERE elementId(item) IN [$neodash_item_base_id, $neodash_item_comp_id]\nWITH CASE WHEN count(DISTINCT item_root) > 1 THEN 'Across Item' ELSE 'Within Item' END AS compare_type\n\nWITH compare_type, [\n  {id: $neodash_item_base_id, version: $neodash_item_base_version_num, label: 'Base'},\n  {id: $neodash_item_comp_id, version: $neodash_item_comp_version_num, label: 'Compare'}\n] AS selections\n\nUNWIND selections AS selection\nMATCH (item:OdmItemValue)<-[item_version:HAS_VERSION]-(item_root:OdmItemRoot) \nWHERE elementId(item) = selection.id \n  AND item_version.version = selection.version\nOPTIONAL MATCH ()-[group_version:HAS_VERSION]->(group:OdmItemGroupValue)-[r3_1:ITEM_REF]->(item)\nWITH selection.label as item_compare, group.name as name, group_version.version as version order by name, version\nWITH DISTINCT item_compare, collect(DISTINCT name+'(V'+version+')') AS group\nWITH apoc.map.fromPairs(collect([item_compare, group])) AS data\nWITH data, \n     CASE WHEN size(data.Base) > size(data.Compare) \n          THEN size(data.Base) \n          ELSE size(data.Compare) \n     END AS maxSize\nUNWIND CASE WHEN maxSize IS NULL OR maxSize = 0 \n            THEN [0] \n            ELSE range(0, maxSize - 1) \n       END AS idx\nRETURN CASE WHEN maxSize > 0 AND idx < size(data.Base) THEN data.Base[idx] END AS Base,\n       CASE WHEN maxSize > 0 AND idx < size(data.Compare) THEN data.Compare[idx] END AS Compare",
          "width": 8,
          "height": 3,
          "x": 16,
          "y": 9,
          "type": "table",
          "selection": {},
          "settings": {
            "refreshButtonEnabled": true,
            "compact": true,
            "wrapContent": true,
            "transposed": false
          }
        }
      ]
    }
  ],
  "parameters": {},
  "extensions": {
    "active": true,
    "activeReducers": [],
    "advanced-charts": {
      "active": true
    },
    "styling": {
      "active": true
    },
    "actions": {
      "active": true
    }
  },
  "uuid": "cf732a09-3c69-4fbc-be7c-ca66f73a9c45"
}